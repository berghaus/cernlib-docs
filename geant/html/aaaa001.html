<PRE>




<H2>Geant  3.21  Routine  AAAA001</H2>


<PRE>


Origin:                                                            Submitted:  01.10.84
Revision:                                                            Revised:  20.04.94
Documentation:


</PRE>  <HR>  <H2>Foreword</H2>


<PRE>    As  the  scale  and  complexity  of  High  Energy
Physics  experiments  increase,  simulation  studies
require  more  and  more  care  and  become  essential
to


   *   design  and  optimise  the  detectors,
   *   develop  and  test  the  reconstruction  and
       analysis  programs,  and
   *   interpret  the  experimental  data.


GEANT  is  a  system  of  detector  description  and
simulation  tools  that  help  physicists  in  such
studies.  The  GEANT  system  can  be  obtained  from
CERN  as  six  Patchy  /CMZ    files:  GEANT,  GEANG,
GEANH,  GEANF,  GEANE  and  GEANX.  The  program  runs
everywhere  the  CERN  Program  Library  has  been
installed  (  At  the  moment  of  writing  these  are  the
systems  on  which  the  CERN  Program  Library  is
maintained:  VM/CMS-HPO-XA-ESA,  SUN,  Silicon
Graphics,  CRAY  Y-XMP,  Apollo  3000  series,  Apollo
10000,  HP  400  series,  HP  700  series,  IBM  RS/6000,
IBM  AIX/370,  VAX/VMS,  Alliant,  Dec  Ultrix,  NeXT,
IBM  MVS-HPO-XA-ESA,  Convex,  MAC/MPW  (partial
implementation),  PC-DOS,  PC-Linux,
PC-Windows/NT.  ).


The  GEANT  and  GEANG  files  contain  most  of  the
basic  code.  The  GEANH  file  contains  the  code  for
the  hadronic  showers  simulation  from  the  program
GHEISHA  .  The  GEANF  file  contains  the  source  of
the  routines  for  hadronic  showers  development
from  the  FLUKA    program  which  is  interfaced  with
GEANT  as  an  alternative  to  GHEISHA  to  simulate
hadronic  cascades.  The  GEANE    file  contains  a
tracking  package  to  be  used,  in  the  context  of
event  reconstruction,  for  trajectory  estimation
and  error  propagation.  The  GEANX  file  contains
the  main  program  for  the  interactive  version  of
GEANT  (GXINT)  and  a  few  examples  of  application
programs  which  may  help  users  to  get  started  with
GEANT.


General  information  concerning  GEANT,  for
example  access  to  the  source  code,  the  list  of
problems  and  their  proposed  corrections,  the
context  of  utilisation  on  the  CERN  machines,  the



status  of  some  application  programs,  the
acquisition  of  documentation,  etc.,  are  kept  up
to  date  through  CERN  news  and  InterNet  news  group
(cern.lgeant)  and  an  electronic  mailing  list
which  is  installed  on  the  CERN  IBM  mainframe
(BITnet/EARN  node  CERNVM).  The  name  of  the  list
is  LGEANT  (see  below  how  to  subscribe).


The  first  version  of  GEANT  was  written  in  1974  as
a  bare  framework  which  initially  emphasised
tracking  of  a  few  particles  per  event  through
relatively  simple  detectors.  The  system  has  been
developed  with  some  continuity  over  the  years


New  versions  may  differ  from  the  previous  ones.
Some  of  the  modifications  may  lead  to  backward
incompatibilities.  The  user  is  therefore  invited
to  read  carefully  the  Patch  HISTORY  of  the
current  GEANT  file  where  all  changes  are
described  in  detail.


The  development  and  the  maintenance  of  GEANT  are
possible  only  thanks  to  the  devoted  and
continuous  collaboration  of  physicists  around
the  world  who  use  the  program  and  contribute
their  feedback  to  the  authors  and  maintainers  at
CERN.  It  is  of  course  impossible  to  mention  all  of
them,  and  new  names  are  added  frequently  to  the
list  of  the  contributors.  The  GEANT  team  wish  to
thank  them  all  and  expresses  its  hope  that  they
will  continue  to  help  us.


GEANT  version  3  originated  from  an  idea  of  Rene
Brun  and  Andy  McPherson  in  1982  during  the
development  of  the  OPAL  simulation  program.
GEANT3  was  based  on  the  skeleton  of  GEANT  version
2  code  .


In  close  collaboration  with  Rene  and  Andy,  Pietro
Zanarini  developed  the  first  versions  of  the
graphics  system  as  well  as  the  early  versions  of
the  interactive  package  initially  based  on
ZCEDEX,  then  upgraded  to  KUIP.


Glenn  Patrick  (RAL)  implemented  a  first  version
of  the  electromagnetic  processes.  Tony
Baroncelli  (Roma)  helped  in  interfacing  GEANT  to
his  hadronic  shower  package  TATINA.  Federico
Carminati  contributed  to  the  interface  with
GHEISHA,  an  hadronic  shower  package  developed  by
Harn  Fesefeldt  (Aachen).


Francis  Bruyant  and  Michel  Maire  (LAPP)  made
substantial  contributions  to  the  geometry,
tracking  and  physics  parts  of  GEANT  while
adapting  the  system  to  the  L3  environment.



Francis  has  been,  for  many  years,  an  essential
collaborator,  testing  new  ideas  for  the  geometry
and  hits  packages.  Michel,  together  with  Elemer
Nagy  and  Vincenzo  Innocente,  developed  the  GEANE
system.


A  very  important  contribution  to  GEANT  has  been
made  byasLzlo  Urban  (KFKI  Budapest)  who  has
continuously  improved  the  electromagnetic
physics  package.  Lazlo  has  spent  a  considerable
amount  of  time  in  reading  the  relevant  papers  in
the  literature  and  in  making  comparisons  with
experimental  results.


Rene  Brun  has  coordinated  the  development  and  the
maintenance  of  GEANT  from  1982  until  1991
(versions  3.00  up  to  3.14).  Federico  Carminati
coordinated  the  development  of  the  versions  3.15
and  3.16  between  1991  and  1993.  Since  January
1994,  the  responsability  for  GEANT  is  in  the
hands  of  Simone  Giani.  Before  assuming  this
responsability,  Simone  made  substantial
improvements  in  the  graphics  and  interactive
packages.  After  he  has  enhanced  the  power  of  the
geometry  package  and  the  performance  of  the
tracking  for  a  new  version  of  GEANT:  in  March  1994
the  version  3.21  has  been  released  and  is  the
current  version  of  GEANT.


Many  people  contributed  their  work  or  their
experience.  We  have  tried  to  acknowledge  their
names  in  the  manual  pages  and  we  apologise  for  any
omissions.


Special  mention  should  be  made  here  of  the
following  contributions:


S.Banerjee  (contribution  to  the  tracking
package),  R.Jones  (contribution  to  the
simulation  of  electromagnetic  processes),
K.Lassila-Perini  (interface  with  FLUKA  and
MICAP),  G.Lynch  (contribution  to  the  multiple
scattering  algorithms),  E.Tchernyaev  (original
code  for  hidden-line  removal  graphics),  J.Salt
(original  interface  to  the  GC  package).


S.  Ravndal  did  a  complete  revision  and  update  of
the  full  documentation  for  the  release  of  GEANT
version  3.21.


Special  thanks  should  go  to  the  authors  of  the
packages  interfaced  with  GEANT,  and  in  particular
to  Harn  Fesefeldt  (GHEISHA)  and  Alfredo  Ferrari
(FLUKA  see  later).  Their  patience  in  explaining
the  internals  of  their  code,  their  experience  and
their  collaborative  and  open  attitude  have  been



instrumental.


Another  special  thanks  goes  to  Mike  Metcalf,  who
helped  to  improve  the  English  and  the  structure
of  the  manual.


Any  reader  who  is  not  familiar  with  GEANT  should
first  have  a  glance  at  the  notes  numbered  001  to
009  in  each  section  of  this  manual.


Despite  our  efforts,  the  documentation  is  still
incomplete  and  far  from  perfect.  We  accept  full
responsibility  for  its  present  status.


Finally,  we  express  our  thanks  to  Michel  Goossens
for  translating  the  SCRIPT/SGML  source  of  the
original  GEANT  manual  into  LaTeX.


</PRE>


<H2>The  GEANT-FLUKA  interface</H2>


<PRE>


Since  version  3.15,  GEANT  includes  an  interface
with  some  FLUKA    routines.  This  part  has  been
updated  and  extended  in  subsequent  releases.


FLUKA  is  a  standalone  code  with  its  own  life.  Only
a  few  parts  have  been  included  into  GEANT,  namely
the  ones  dealing  with  hadronic  elastic  and
inelastic  interactions.


The  implementation  of  FLUKA  routines  in  GEANT
does  not  include  any  change,  apart  from  interface
ones  and  those  agreed  by  the  FLUKA  authors.
Whenever  different  options  are  available  in
FLUKA,  the  one  suggested  by  the  authors  have  been
retained.  Nevertheless  the  results  obtained  with
FLUKA  routines  inside  GEANT  could  not  be
representative  of  the  full  FLUKA  performances,
since  they  generally  depend  on  other  parts  which
are  GEANT  specific.


The  routines  made  available  for  GEANT  have  been
extensively  tested  and  are  reasonably  robust.
They  usually  do  not  represent  the  latest  FLUKA
developments,  since  the  policy  is  to  supply  for
GEANT  well  tested  and  reliable  code  rather  than
very  recent  developments  with  possibly  better
physics  but  also  still  undetected  errors.


It  is  important  that  GEANT  users  are  aware  of  the
conditions  at  which  this  code  has  been  kindly
made  available:



   *   relevant  authorship  and  references  about
       FLUKA    should  be  clearly  indicated  in  any
       publication  reporting  results  obtained  with
       this  code;
   *   the  FLUKA  authors  reserve  the  right  of
       publishing  about  the  physical  models  they
       developed  and  implemented  inside  FLUKA,  GEANT
       users  are  not  supposed  to  extract  from  the
       GEANT-FLUKA  code  the  relevant  routines  running
       them  standalone  for  benchmarks;
   *   more  generally,  FLUKA  routines  contained  in
       the  GEANF  file  are  supposed  to  be  included  and
       used  with  GEANT  only:  any  other  use  must  be
       authorised  by  the  FLUKA  authors.


</PRE>


<H2>Documentation</H2>


<PRE>


The  main  source  of  documentation  on  GEANT  is  this
manual.  Users  are  invited  to  notify  any
correction  or  suggestion  to  the  authors.


A  detailed  description  of  the  history  of
modifications  to  the  GEANT  code  is  contained  in
the  $VERSION  Patch  in  the  GEANT  file.


GEANT  is  part  of  the  CERN  Program  Library,  and
problems  or  questions  about  GEANT  should  be
directed  to  the  Program  Library  Office  (see  next
section).


GEANT  problems  can  be  submitted  to  an  InterNet
discussion  group  cern.lgeant.


A  mailing  list  is  maintained  on  CERN's  central
IBM  machine  (BITnet  node  CERNVM)  via  the  LISTSERV
mechanism.  LISTSERV  acts  as  a  rudimentary
conferencing  system,  which  forwards  the  mail
received  to  all  subscribed  users  and  to  the
InterNet  group  cern.lgeant.  The  list  is
accessible  to  all  users  who  have  an  e-mail
connection  to  CERNVM.  To  subscribe  to  the  list
from  a  BITnet  node  a  user  has  to  send  the
following  message  to  LISTSERV  at  CERNVM  using  the
local  BITnet  message  facility:


                                            SUBSCRIBE  LGEANT


From  a  non-BITnet  node,  the  user  can  send  an
ordinary  mail  message  to  the  user  LISTSERV  at
CERNVM  containing  that  single  line.


Together  with  the  GEANT  library  comes  a



correction  cradle  (see  section  on  maintenance
policy)  which  contains  the  history  of  the
modifications  to  the  current  version  of  the  GEANT
program.  This  file  is  accessible  to  all  users  in
the  PRO  area  and  can  be  found  in:


                                                 GCORRxxx.CAR


where  xxx  is  the  version  number.


Documentation  on  the  elements  of  the  CERN  Program
Library  used  by  the  GEANT  program  is  available
from  the  CERN  Program  Library  Office.


</PRE>


<H2>Update  policy</H2>


<PRE>


The  GEANT  program  is  constantly  updated  to
reflect  corrections,  most  of  the  time  originating
from  users'  feed-back,  and  improvements  to  the
code.  This  constant  evolution,  which  is  one  of
the  reasons  for  the  success  of  GEANT,  poses  the
serious  problem  of  managing  change  without
disrupting  stability,  which  is  very  important  for
physicists  doing  long  production  runs.


In  the  CERN  Program  Library  maintenance  scheme,
three  versions  of  any  product  are  present  at  the
same  time  on  the  central  systems,  in  the  OLD,  PRO
and  NEW  areas  with  those  same  names.  This  scheme
does  not  apply  to  GEANT  because  every  new  release
usually  contains  modifications  in  the  physics
which  can  produce,  we  hope,  better  but  often
different  results  with  respect  to  the  previous
version.  It  is  therefore  appropriate  to  offer  to
the  users  an  extra  level  of  protection  against
running  inadvertedly  the  wrong  version  by
appending  the  version  number  to  all  the  files  of
GEANT.  In  this  way  the  users  will  have  to  change
their  procedure  to  change  the  version  of  GEANT.


On  the  other  hand,  the  new  user  should  not  bother
about  version  numbers  and  correction  files,  and
so  an  alias  is  installed  on  all  systems  without
any  version  number,  always  pointing  to  the  latest
released  version.


As  said  before,  users'  feed-back  is  of  paramount
importance  in  detecting  problems  or  areas  for
improvement  in  the  system,  so  the  new  version  is
made  available  in  the  NEW  area  well  before  the
official  release.  If,  on  the  one  hand,  those  who
use  this  version  do  so  at  their  own  risk,  on  the



other  hand  users  are  encouraged  to  perform  as
much  testing  as  possible,  in  order  to  detect  the
maximum  number  of  problems  before  the  final
release.  Modifications  in  the  pre-release
version  are  made  directly  in  the  source  code.


When  problems  are  discovered,  which  may  seriously
affect  the  validity  of  the  results  of  the
simulation,  they  are  corrected  and  the  library
recompiled  in  the  /new  area.  To  minimise  network
transfer  for  remote  users  and  in  the  interest  of
the  stability  of  the  system,  the  source  code  of
the  released  version  in  PRO  is  not  touched,  but
rather  the  correction  is  applied  via  a  so-called
correction  cradle  which  is  a  file  containing  the
differences  between  the  original  and  the
corrected  version  in  a  format  required  by
PATCHY/CMZ.  Both  these  programs  can  read  the
original  source  and  the  correction  cradle  and
produce  the  corrected  source.  The  corrected
car/cmz  source  and  the  corrected  binary  library
are  made  then  available  in  /pro  at  the  following
CERNLIB  release  (when  /new  becomes  /pro).


The  cmz  source  files  contain  the  full  history  of
the  corrections  applied  with  proper  versioning,
so  that  every  intermediate  version  can  be
rebuild.  Users  at  CERN  should  not  need  to  use  the
correction  cradle  other  than  for  documentation
purposes.  Remote  users  may  want  to  obtain  the
cradle  and  apply  the  corrections.  At  every
CERNLIB  release  the  correction  cradle  is
obviously  reset  to  be  empty,  as  all  the
corrections  have  been  applied  in  the  code
directly.  The  correction  cradle  for  the  OLD
version  is  available  but  has  to  be  considered
frozen.  No  correction  is  ever  applied  to  an  old
version.


New  versions  of  GEANT  are  moved  into  the  PRO  area
synchronously  with  releases  of  the  CERN  Program
Library.  If  no  new  version  of  GEANT  is  available
at  the  time  of  the  release  of  the  Program  Library,
the  GEANT  files  do  not  change  their  location  and
the  production  version  remains  the  same.


</PRE>


<H2>Availability  of  the  documentation</H2>


<PRE>


This  document  has  been  produced  using
LaTeX(Leslie  Lamport,  LaTeX  --  A  Document
Preparation  System.  Addison--Wesley,  1985)  with
the  cernman  and  cerngeant  style  options,



developed  at  CERN.  A  printable  version  of  each  of
the  sections  described  in  this  manual  can  be
obtained  as  a  compressed  PostScript  file  from
CERN  by  anonymous  ftp.  You  can  look  in  the
directory  described  in  the  procedure  below  for
more  details.  For  instance,  if  you  want  to
transfer  the  description  of  the  physics  routines,
then  you  can  type  the  following  (commands  that
you  have  to  type  are  underlined):(You  can  of
course  issue  multiple  get  commands  in  one  run.)



                   ftp  asis01.cern.ch
                   ________________________________________________


                   Trying  128.141.201.136...



                   Connected  to  asis01.cern.ch.



                   220  asis01  FTP  server  (SunOS  4.1)  ready.



                   Name  (asis01:username):  anonymous
                                             _______________________


                   Password:  your_mailaddress
                              _________________________________________


                   ftp>  binary
                         _______________


                   ftp>  cd  cernlib/doc/ps.dir/geant
                         _________________________________________________________________________


                   ftp>  get  phys.ps.Z
                         __________________________________


                   ftp>  quit
                         _________
</PRE>
