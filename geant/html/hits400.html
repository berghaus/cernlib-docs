<PRE>




<H2>Geant  3.10  Routine  HITS400</H2>


<PRE>


Origin:  R.Brun,H.  Boerner            Submitted:  01.10.81
Revision:                                                            Revised:  18.12.93
Documentation:


</PRE>  <HR>  <H2>Intersection  of  a  track  with  a
cylinder  or  a  plane</H2>


<PRE>



       CALL  GICYL                       (R,X1,X2,S1,S2,IC,XINT*,SINT*,PZINT*,IFLAG*)



R                         (REAL)  radius  of  cylinder  in  cm;
X1                        (REAL)  array  of  6,  (x,  y,  z,  dx/ ds,

                                                 st
                          dy/ ds,  dz/ ds)  of  1        point;
X2                        (REAL)  array  of  6,  (x,  y,  z,  dx/ ds,

                                                 nd
                          dy/ ds,  dz/ ds)  of  2        point;

                                                         st
S1                        (REAL)  track  length  s  at  1        point;

                                                         nd
S2                        (REAL)  track  length  s  at  2        point;
IC                        (INTEGER)  type  of  interpolation:

                          1             straight  line  defined  as
                                        (Xi(1),Xi(2),Xi(3))  +  s
                                        (Xi(4),Xi(5),Xi(6)),  where  i  is  1
                                        or  2  according  to  which  of  the  two
                                        points  is  inside  the  cylinder;
                          2             straight  line  going  from
                                        (X1(1),X1(2),X1(3))  to
                                        (X2(1),X2(2),X2(3));
                          3             third  degree  curve  with:


                                                     3        2
                                        "P(s) = "a  s   +"b  s   +"c  s+"d                   X  i = ("P (S  i), . ((d"P )/ (ds))_  *
 *          )        i @

                                                                                                                                 s=*
 *S  i


XINT                      (REAL)  array  of  6  x,  y,  z,  dx/ ds,  dy/ ds,
                          dz/ ds  at  intersection  point;
SINT                      (REAL)  S  at  intersection  point;
PZINT                     (REAL)  phi     ,  z,  dphi      / dr,  dz/ dr  in
                          cylindrical  coordinates  at  intersection
                          point;
IFLAG                     (INTEGER)  return  flag:

                          0             track  does  not  intersect  cylinder;
                          1             track  intersects  cylinder.



Calculates  intersection  of  track  with  a  cylinder
of  radius  R.  The  track  is  approximated  by  a  cubic
in  the  track  length.  To  improve  stability,  the
coordinate  system  is  shifted.



       CALL  GIPLAN                         (YC,X1,X2,S1,S2,IC,XINT*,SINT*,PZINT*,IFLAG*)



The  arguments  have  the  same  meaning  than  in  the
previous  routine,  apart  from:


YC                        (REAL)  y  coordinate  of  plane;


Calculates  intersection  of  track  with  a  plane
parallel  to  x- z.  The  track  is  approximated  by  a
cubic  in  the  track  length.  To  improve  stability,
the  coordinate  system  is  shifted.


Note:  the  default  accuracy  is  10  microns.  The
value  of  EPSI  (internal  variable)  must  be  changed
for  a  better  precision.
</PRE>
