<PRE>




<H2>Geant  3.16  Routine  HITS300</H2>


<PRE>


Origin:  R.Brun,  W.Gebel                 Submitted:  10.08.84
Revision:                                                            Revised:  18.12.93
Documentation:


</PRE>  <HR>  <H2>Routines  to  store  and  retrieve
DIGItisations</H2>


<PRE>



       CALL  GSDIGI                         (ISET,IDET,LTRA,NTRA,NUMBV,KDIGI,IDIG*)



ISET                      (INTEGER)  set  number;
IDET                      (INTEGER)  detector  number;
LTRA                      (INTEGER)  array  of  NTRA  track  numbers
                          producing  this  digitisation;
NUMBV                     (INTEGER)  volume  numbers  corresponding
                          to  list  NAMESV  of  GSDET;
KDIGI                     (INTEGER)  array  of  current  digisation
                          elements;
IDIG                      (INTEGER)  stored  digitisation  number,
                          if  0,  digitisation  has  not  been  stored.


Stores  element  values  for  current  digitisation
into  the  data  structure  JDIGI.



       CALL  GPDIGI                         (CHSET,CHDET)



CHSET                     (CHARACTER*4)  set  name,  if  '*'  prints
                          all  JDIGI  banks  of  all  sets;
CHDET                     (CHARACTER*4)  detector  name,  if  '*'
                          prints  digitisations  in  all  detectors
                          of  set;  CHSET


Prints  JDIGI  banks  for  detector  CHDET  of  set
CHSET.



       CALL  GFDIGI                         (CHSET,CHDET,NTDIM,NVDIM,NDDIM,NDMAX,NUMVS,
                                            LTRA*,NTRA*,NUMBV*,KDIGI*,NDIGI*)



CHSET                     (INTEGER)  set  name;
CHDET                     (INTEGER)  detector  name;



                                      s
NTDIM                     (INTEGER)  1   t  dimension  of  LTRA,  maxmum
                          number  of  tracks  contributing  to  each
                          hit  to  be  returned;

                                      st
NVDIM                     (INTEGER)  1        dimension  of  arrays
                          NUMVS,  NUMBV,  same  as  argument  NV  of
                          GSDET;

                                      st
NDDIM                     (INTEGER)  1        dimension  of  KDIGI,  same
                          as  argument  ND  of  GSDETD;
NDMAX                     (INTEGER)  maximum  number  of
                          digitisations  to  be  returned,  second
                          dimension  of  arrays  NTDIM,  NUMBV  and
                          KDIGI;
NUMVS                     (INTEGER)  is  a  1-dim  array  of  length
                          NVDIM  that  contains  the  copy  numbers
                          identifying  the  detector  to  be
                          selected,  all  0  is  interpreted  as  all
                          copies  of  detector  CHDET;
LTRA                      (INTEGER)  is  a  2-dim  array  NTDIM,NDMAX
                          that  contains  for  each  digitisation  the
                          numbers  of  the  tracks  which  have
                          produced  it;
NTRA                      (INTEGER)  is  a  1-dim  array  of  length
                          NDMAX  that  contains,  for  each
                          digitisation,  the  number  of  tracks
                          contributing,  in  case  this  number  is
                          greater  than  NTDIM,  only  the  first  NTDIM
                          corresponding  tracks  are  returned  on
                          LTRA;
NUMBV                     (INTEGER)  is  a  2-dim  array  NVDIM,NDMAX
                          that  contains,  for  each  digitisation,
                          the  list  of  volume  numbers  which
                          identify  each  detector;
KDIGI                     (INTEGER)  is  a  2-Dim  array  NDDIM,NDMAX
                          that  contains  the  NDIGI  digitisations
                          returned;
NDIGI                     (INTEGER)  is  the  total  number  of
                          digitisations  in  this  detector,  in  case
                          the  total  number  of  digitisations  is
                          greater  than  NDMAX,  NDIGI  is  set  to
                          NDMAX+1  and  only  NDMAX  digitisations
                          are  returned.


Returns  the  digitisations  for  the  detector  CHDET
identified  by  the  list  of  copy  numbers  NUMVS
belonging  to  set  CHSET.  The  maning  of  the
variables  is  the  following:



    KDIGI(1,I)                         digitisation  element  1  for  digitisation  number  I



    NUMBV(1,I)                         first  volume  number  for  digitisation  number  I



    LTRA  (1,I)                        number  of  the  first  track  contributing  to  digitisation
                                       number  I



In  the  calling  routine,  the  arrays  LTRA,  NTRA,
NUMVS,  NUMBV,  KDIGI  must  be  dimensioned  to:
           LTRA  (NTDIM,NDMAX)
           NTRA  (NDMAX)
           NUMVS(NVDIM)
           NUMBV(NVDIM,NDMAX)
           KDIGI(NDDIM,NDMAX)
</PRE>
