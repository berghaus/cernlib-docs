<HEAD>
<TITLE> Formats for the text input to TZINIT</TITLE>
</HEAD>
<BODY><P>
 <HR> <A NAME=tex2html39 HREF=tex2htmlindex2_4.html><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/next_motif.gif"></A> <A NAME=tex2html37 HREF=ZEBTZ.html><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/up_motif.gif"></A> <A NAME=tex2html31 HREF=chapter2_2.html><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/previous_motif.gif"></A>  <A NAME=tex2html41 HREF=tex2htmlindex2_4.html><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/index_motif.gif"></A><BR>
<B> Next:</B> <A NAME=tex2html40 HREF=tex2htmlindex2_4.html>Index</A>
<B>Up:</B> <A NAME=tex2html38 HREF=ZEBTZ.html>No Title</A>
<B> Previous:</B> <A NAME=tex2html32 HREF=chapter2_2.html> Using the TZ </A>
<HR> <P>
<H1><A NAME=SECTION0030000000000000000> Formats for the text input to TZINIT</A></H1>
<P>
<A NAME=secTZFORMATS><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/invis_anchor.xbm"></A>
<P>
<H1><A NAME=SECTION0031000000000000000> Out-line</A></H1>
<P>
The input to <A HREF=../../zebra/ZEBTZ/chapter2_2.html#TZINIT>TZINIT</A> is presented on a formatted text file
of 80-column card-images,
giving the titles one after the other,
as shown by the example on the next page.
<P>
Each title starts with the 'title header line'
<tt>*DO ...</tt> (see section <A HREF=chapter2_3.html#secTZtitleheaderlines>19.3</A>)
which selects mode and options for the reading of its
associated ``title data''.
These have to come immediately and completely after the
title header line.
<P>
Normal mode is ``free-field format'' where the data are read line-by-line
and the text is interpreted.
The mode of each data word is taken from the way it is written:
integer data have neither the decimal point nor an exponent,
floating data have either or both,
Hollerith data start with : or ' or &quot;,
octal data are pre-fixed with <tt>#O</tt>;
see section <A HREF=chapter2_3.html#secTZfreefieldinput>19.4</A> for full details.
<P>
With ``Fortran format'' the data are read by a single
Fortran <tt>READ</tt> statement with the FORMAT taken from the <tt>-F</tt> option on
the title header line.
This is useful for computer generated titles.
<P>
``Control lines'' to <A HREF=../../zebra/ZEBTZ/chapter2_2.html#TZINIT>TZINIT</A> may be given interspersed
with the titles.
Global options are selected with control lines;
other examples are the comment line with  <tt>*-</tt>  in column 1,
and the input terminator <tt>*FINISH</tt>;
see section <A HREF=chapter2_3.html#sectzcontrollines>19.2</A> for details.
<P>
Control lines to <A HREF=../../zebra/ZEBTZ/chapter2_2.html#TZINIT>TZINIT</A>, including title-header lines starting
with <tt>*DO</tt>, are handled case-insensitive, ie. they are converted
to upper case before processing.
<P>
<PRE><TT>*-------            TITLE VERSION A3
*PRINT
*.-------1---------2---------3---------4---------5---------6---------7
*DO  RTBC  -iF                   #. 810127     CERN  ROLL 103
13.       1100.
            .99999  +.00042  +.00302
           -.00042   .99993  -.0023
           -.00302  +.0023    .99993     0.     +.015     1.963

*DO  CAM1  -e -n27 -c11 -iF      #. 810121 17.27  ROLL 103
 1 CAM       3.  12.    9.067    11.8516   75.6561     25.    -75.6561
 1 MED       2.        1.51      1.5       1.458     2.382     1.57
             4.06      1.0884
 1 DIST       -.00169     -.00004      .015        .0011      -.0001
               .00394     -.00245      .00378      .051        .0023
               .033        .09

*DO  FID1  -c11 -iF              #. 810121 17.27  ROLL 103  ERASME
            12.
 1 4   1     1.  -17.2475  -18.6369
 1 4   2     2.  -17.2595   -4.2708
 1 4   3     3.    -.7761   -4.3177
 1 1   1    11.  -13.8081  -15.9118
 1 1   2    12.  -13.7343   -7.5253
 1 1   3    13.   -4.8669   -7.5898
 1 1   4    14.   -4.8931  -15.9473
 1 2   1    21.  -13.0353  -15.6000
 1 2   2    22.  -12.8979   -7.3464
 1 2   4    24.   -3.7895  -15.6767
 1 3   3    33.   -2.6674  -17.2822
 1 3   4    34.   -3.1636  -17.8522

*DO  CAM2  -e -n27 -c11 -iF      #. 810121 17.27  ROLL 103
 2 CAM       3.  12.    9.1488  -10.3208   75.673      25.    -75.673
 2 MED       2.        1.51      1.5       1.458     2.382     1.57
             4.06      1.0884
 2 DIST       -.0017       .00005      .015       -.0011      -.0001
               .00043     -.00443     -.00278      .0065      -.0024
               .033        .05

*DO  FID2  -c11/40 -iF           #. 810121 17.27  ROLL 103  ERASME
            13.
 2 4   1     1.  -17.4350    3.9107     examples of other representations
 2 4   2     2.  -17.4786   18.2503     integer    15  -24  0
 2 4   3     3.    -.8612   18.2306     floating   -.123E-7  1E-12
 2 1   1    11.  -13.8891    7.4810     octal      #0731244600
 2 1   2    12.  -13.8296   15.8810     hex        #xffff
 2 1   3    13.   -4.9569   15.7810     Hollerith  :PISA :BARI
 2 1   4    14.   -4.9724    7.4133                :K*(1430)
 2 2   1    21.  -13.1122    7.3163                'text with blanks'
 2 2   3    23.   -3.7338   15.3468                &quot;text with ' and blank&quot;
 2 2   4    24.   -3.8710    7.1994
 2 3   1    31.  -15.4499    4.5935
 2 3   2    32.  -15.8947    5.0865
 2 3   4    34.   -3.2437    4.4470
*.-------1---------2---------3---------4---------5---------6---------7</TT></PRE>
<P>
<H1><A NAME=SECTION0032000000000000000> Control-lines</A></H1>
<P>
<A NAME=sectzcontrollines><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/invis_anchor.xbm"></A>
<P>
Control-lines carry special instructions to <A HREF=../../zebra/ZEBTZ/chapter2_2.html#TZINIT>TZINIT</A>;
they may only be given between titles,
and not within the data-body of a particular title.
An option selected by a control line is switched on or off
at the moment the line is read, and stays in effect until
changed by the inverse selection,
but the effect does not carry from one call to <A HREF=../../zebra/ZEBTZ/chapter2_2.html#TZINIT>TZINIT</A> to the next.
<P>
<PRE><TT>*---        normal comment line
   *.--        non-printing comment line
               blank lines are allowed and ignored

   *LOG        logging information to be printed by TZINIT;
   *LOG  OFF   switch off  (default : according to the log level of
                                      the store, normally 'on')

                  If LOG is 'on' TZINIT will echo on the log-file
                  each control line and each title header line read.

   *PRInt      echo data lines for free-field format titles;
   *PRInt OFF  switch off  (default : 'off')

                  *PRINT implies *LOG

   *USer       call TZUSER for every title bank;
   *USer OFF   switch off  (default : 'off')

   *KIll       kill the run also for slight trouble;
   *KIll OFF   switch off  (default : 'off')

   *ANYWAY     TZINIT is to return to the caller even for fatal errors,
               IQUEST(1) = number of errors, =0 normally

   *FINish     end of input data</TT></PRE>
<P>
One gives <tt>*FINISH</tt> only to terminate titles on
the ``standard input file'' (the ``card reader'') in order to
separate from further input data.
For stand-alone files this is not necessary, as the EOF will
terminate correctly.
On the IBM it could even be harmful with concatenated title files.
<P>
<H1><A NAME=SECTION0033000000000000000> Title header lines</A></H1>
<P>
<A NAME=secTZtitleheaderlines><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/invis_anchor.xbm"></A>
<P>
A title-header line signals the start of data for a new title bank;
it specifies the ID of the title bank,
the way the data are to be read, and further options.
Its format is:
<P>
<PRE><TT>*DO  &lt;idh&gt; [idn]  [-&lt;opt&gt;&lt;option text&gt;]   [#. comment ]</TT></PRE>
<P>
<DL COMPACT>
<DT>*DO
<DD>   in cols 1/4 marks the header line;
<DT>&lt;idh&gt;
<DD> is the 4 character Hollerith bank <tt>ID</tt>;
<DT>&lt;idn&gt;
<DD> is the numeric bank <tt>ID</tt>, integer, if any;
<DT>&lt;opt&gt;
<DD> is a single option letter,
<DT>&lt;otx&gt;
<DD> is the option text, if needed.
</DL>The following options are available:
<P>
<DL COMPACT>
<DT>-F(format)
<DD>  read the data with a single formatted Fortran
               <tt>READ</tt> statement, using the <tt>FORMAT</tt> given, which must
               not contain blanks, the brackets must be present.
<DT>-Itext
<DD>  set the I/O characteristic for the bank, with <tt>text</tt>:<BR><tt>B</tt>, <tt>I</tt>, <tt>F</tt> or <tt>D</tt> if the bank is all bits, integer,
               floating, or double precision;<BR><tt>(string)</tt> where <tt>string</tt> is the I/O characteristic,
               (see routine <A HREF=../../zebra/ZEBMZ1/chapter2_1.html#MZFORM>MZFORM</A>);<BR>the default is: type undefined
<DT>-Nn
<DD> expect <tt>n</tt> data words, for <tt>-F</tt> this must be exact; for free-field
               format this may be omitted if less than 2000 words are to be
               read and if the size is not to be changed by <A HREF=../../zebra/ZEBTZ/chapter2_2.html#TZUSER>TZUSER</A>.
               A bank will initially be lifted to accomodate <tt>&lt;n&gt;</tt> data words to
               be read and will be shortened when input processing is complete.
<DT>-U[n]<DD> call <A HREF=../../zebra/ZEBTZ/chapter2_2.html#TZUSER>TZUSER</A> for this bank, passing <tt>n</tt> as <tt>NPARA</tt>, 
               zero if absent.
</DL>For free-field format only:
<P>
<DL COMPACT>
<DT>-C[a][/e]<DD>  use columns <tt>a/e</tt> only on each line,
                defaults:  1 for a,   80 for e<BR>Ex.:  <tt>-C11/72</tt>   use only the text on columns 11 to 72
                      on each line, except: <tt>'*'</tt> in col. 1 is forbidden
<DT>-E[n]<DD>  expect exactly <tt>&lt;n&gt;</tt> words (as given by <tt>-Nn</tt>).
                If less or more data words are found, <A HREF=../../zebra/ZEBTZ/chapter2_2.html#TZINIT>TZINIT</A> will
                print a message and go to <A HREF=../../zebra/ZEBMZ3/chapter2_1.html#ZFATAL>ZFATAL</A> on end of input.
<DT>-S[n]<DD>  true size of the bank is <tt>&lt;n&gt;</tt> words (as given by <tt>-Nn</tt>).
                The bank is not reduced to the number of data words
                actually read.
<DT>-A[n][C][W]<DD>  
                initialize Hollerith handling as though the control-item
                <tt>#A[n][C][W]</tt>  had been read; see next paragraph.
</DL>
<H1><A NAME=SECTION0034000000000000000> Free-field input</A></H1>
<P>
<A NAME=secTZfreefieldinput><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/invis_anchor.xbm"></A>
<P>
In free-field format the data-items are given one after the other,
separated by blanks.
The mode of each data-item is recognized from the way it
has been written by the user;
thus 12 is an integer,
<tt>#012</tt> is an octal integer (of value 10),
<tt>12.</tt> is a floating-point number,
and <tt>:ABC</tt> is Hollerith.
The rules for writing the data items try to strike a balance
between freedom and catching mistakes; they are the following:
<P>
<b>Integer</b>:  a string of digits, maybe preceded by + or -
<PRE><TT>Examples:    123  +123  -123  1  0</TT></PRE>
<b>Floating</b>: a number containing a decimal dot and/or an exponent
<PRE><TT>Examples:       12.     +12.34  -.34   1.  .1  -12.34
                      12E     +12.34E -.34E  1E  .1E -12.34E
                     -12.34E5  12.E5  12E5  12E+5  12E-5
                     -12.34+5  12.+5  12+5  12+5   12-5</TT></PRE>
<b>Double precision</b>: a number containing an exponent letter <tt>D</tt>
<PRE><TT>Examples:       12D     +12.34D -.34D  1D  .1D -12.34D
                     -12.34D5  12.D5  12D5  12D+5  12D-5</TT></PRE> 
<b>Binary - Octal - Hexadecimal</b>:  a number preceded
by <tt>#B</tt>, <tt>#b</tt>, <tt>#O</tt>, <tt>#o</tt>, <tt>#0</tt>, <tt>#X</tt> or <tt>#x</tt>,
which will be stored right-justified with zero-fill;
bits beyond the capacity of a computer word are truncated on the left.
<PRE><TT>Examples :  #B10001  #b11101  #b1111111000111000011111111
                  #017777  #O17777  #o33211234567 (32 bits!)
                  #X177AB  #x17cde  #xffffFFFF    (32 bits!)</TT></PRE> 
<b>BCD</b>:  must start with  <tt>'</tt> or <tt>&quot;</tt> or <tt>:</tt> thereby
selecting the delimiting character, followed by the Hollerith string,
terminated with the delimiter (which is ``<tt>blank</tt>'' for ``:'').
<PRE><TT>Examples:    :ABCD    :PI+   :K*   :K(1430)   :RATHERLONGSTRING
                    'AB CD'  :it's        &quot;'ab' 'cd'&quot;</TT></PRE> 
<b>Repeat count</b>:  indicates the number of times which the data item which
follows immediately is to be stored.
It is an unsigned integer larger than 1 followed by ``<tt>*</tt>''.
<PRE><TT>Examples:  100*0   4* -.0379   3*:PI-   2* :K(1430)  2*:LONGSTRING</TT></PRE> 
<b>Comment</b>:    can be either trailing or interspersed.
A comment starts with  <tt>#</tt>.  and stops with the next  <tt>#</tt>  or the end-of-line.
<PRE><TT>Example:   12  #. any text, but not a number-sign  #  13</TT></PRE>
<P>
<H2><A NAME=SECTION0034100000000000000> Hollerith handling</A></H2>
<P>
Hollerith text is by default stored in A4 format,
thus the data-item <tt>&quot;:ABCDEF&quot;</tt> gives on all machines 2 words
containing <tt>&quot;ABCD&quot;</tt> and &quot;EF  &quot; with blank-fill.
If this is not what is needed it can be changed either with
the ``control item'' <tt>#A</tt> or with the title header line option <tt>-A</tt>,
which have the same syntax.
<P>
Variable length strings could be awkward to handle,
therefore one can ask <A HREF=../../zebra/ZEBTZ/chapter2_2.html#TZINIT>TZINIT</A> to store the Hollerith string preceded
by a word count as an extra integer word,
optionally preceded in turn by a character count:
<PRE><TT>Header-line option:   -A[n][C][W]
      Control item:   #A[n][C][W]

   with   n:  if given it selects An representation,
               if absent or if n is larger than the maximum number
               of characters per word, the data are stored continuous
               without trailing blanks in each word.

          C:  if given an extra word is stored specifying the
               number of characters in the string, not counting
               trailing blanks in any word.

          W:  if given an extra word is stored specifying the
               number of words occupied by the BCD string,
               excluding itself and the character count, if present.

Example:  #A4CW  :LONGSTRING

          would give 5 words:
          IQ(L)   = 10       character count
          IQ(L+1) = 3        word count
          IQ(L+2) = 4HLONG
          IQ(L+3) = 4HSTRI
          IQ(L+4) = 4HNG</TT></PRE> 
<H3><A NAME=SECTION0034110000000000000> Other control items</A></H3>
<P>
<b>#Double </b> instructs <A HREF=../../zebra/ZEBTZ/chapter2_2.html#TZINIT>TZINIT</A> to read and store all floating-point
numbers that follow as double-precision numbers.
<P>
<b>#Normal </b> reverts to normal, cancelling the effect
of a previous <tt>#D</tt> for the numbers that follow the <tt>#N</tt>.
<P>
Control-items must be blank-terminated like data items
and may be freely mixed with data items.
They must not occur between a multiplier and its data item.
<P>
The option selected by a control item applies to all following
data until changed again by a new control item.
<P>
As an example of usage, suppose we have this title bank:
<P>
<PRE><TT>*DO FZO 21  -i(3I *H 1I *H)
      #. mode nwrec  opt    name #   #ACW
            4     0  :TLO3  :/dev/mt12</TT></PRE>
<P>
giving the parameters for a file to be used by FZ of Zebra.
(The I/O characteristic is only useful if one wanted Zebra
 to print this bank, which is unlikely in this case.)
<P>
The program could digest this as follows:
<PRE><TT>CHARACTER    CHOPT*8, CHNAM*80

      LUN = 21
      CALL TZFIND (0, LT, 'FZO ', LUN, 0)
      IF (LT.EQ.0)                 GO TO no output
      MODE   = IQ(LT+1)
      NWREC  = IQ(LT+2)
      LOPT   = LT+3
      LNAM   = LOPT + IQ(LOPT+1) + 2
      NCHOPT = IQ(LOPT)
      NCHNAM = IQ(LNAM)
      CALL UHTOC (IQ(LOPT+2),99, CHOPT, NCHOPT)
      CALL UHTOC (IQ(LNAM+2),99, CHNAM, NCHNAM)
      CALL MZDROP (0,LT,'.')

      IF (MODE ...
               ...
        ELSEIF (MODE.EQ.4)  THEN
          IF (NWREC.EQ.0)  NWREC = 5760
          CALL CFOPEN (IQUEST(1),1,NWREC,'w',0,CHNAME(1:NCHNAM),ISTAT)
          CALL FZFILE (LUN,NWREC,CHOPT(1:NCHOPT))
        ELSEIF (MODE ...
                     ...
        ENDIF</TT></PRE>
<P>
<H1><A NAME=SECTION0035000000000000000> Fortran formatted input</A></H1>
<P>
With Fortran formatted input all the data for the complete title bank
are read with a single <tt>READ</tt> statement using the format given
on the header line.
For this to be possible the exact number of words to be read
must be specified with the <tt>-N</tt> option.
<P>
<H2><A NAME=SECTION0035100000000000000> Example</A></H2>
<P>
<PRE><TT>*DO  FIDU 1 -IF -N37 -F(10X,F10.0/(10X,3F10.0))
                   12.
        1 4   1     1.     -17.2475  -18.6369
        1 4   2     2.     -17.2595   -4.2708
        1 4   3     3.       -.7761   -4.3177
        1 1   1    11.     -13.8081  -15.9118
        1 1   2    12.     -13.7343   -7.5253
        1 1   3    13.      -4.8669   -7.5898
        1 1   4    14.      -4.8931  -15.9473
        1 2   1    21.     -13.0353  -15.6000
        1 2   2    22.     -12.8979   -7.3464
        1 2   4    24.      -3.7895  -15.6767
        1 3   3    33.      -2.6674  -17.2822
        1 3   4    34.      -3.1636  -17.8522
       *.-------1---------2---------3---------4---------5</TT></PRE>
<P>
The option <tt>-IF</tt> specifying the I/O characteristic
is important in this case.
It causes the execution of a Fortran <tt>READ</tt> statement with an I/O list
of type <tt>REAL</tt>;
on some machines Fortran is not able to read acting solely under
<tt>FORMAT</tt> control, ignoring the type of the I/O list.
<P>
 <H2>References</H2>
<P><A NAME=BIBLIO HREF=../../general/biblio/bibliography.html>Global CERN library references</A><P>/user/goossens/cnasall/cnasbibl,/user/goossens/cnasall/textproc}    
<HR> <A NAME=tex2html39 HREF=tex2htmlindex2_4.html><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/next_motif.gif"></A> <A NAME=tex2html37 HREF=ZEBTZ.html><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/up_motif.gif"></A> <A NAME=tex2html31 HREF=chapter2_2.html><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/previous_motif.gif"></A>  <A NAME=tex2html41 HREF=tex2htmlindex2_4.html><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/index_motif.gif"></A><BR>
<B> Next:</B> <A NAME=tex2html40 HREF=tex2htmlindex2_4.html>Index</A>
<B>Up:</B> <A NAME=tex2html38 HREF=ZEBTZ.html>No Title</A>
<B> Previous:</B> <A NAME=tex2html32 HREF=chapter2_2.html> Using the TZ </A>
<HR> <P>
<HR>

</BODY>
<P><ADDRESS>
goossens@cern.ch
</ADDRESS>