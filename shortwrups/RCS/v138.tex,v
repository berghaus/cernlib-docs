head	1.3;
access;
symbols;
locks;
comment	@% @;


1.3
date	96.05.14.08.07.29;	author goossens;	state Exp;
branches;
next	1.2;

1.2
date	95.02.28.08.33.20;	author goossens;	state Exp;
branches;
next	1.1;

1.1
date	94.11.01.09.21.50;	author goossens;	state Exp;
branches;
next	;


desc
@new KSK
@


1.3
log
@Optimized version (KSK)
@
text
@% 16 jan 95 ksk
\Version {RNMNML}                       \Routid{V138}
\Keywords{DISTRIBUTION MULTINOMIAL NUMBER RANDOM}
\Author{D. Drijard, K.S. K\"olbig}            \Library{MATHLIB}
\Submitter{}                        \Submitted{15.10.1994}
\Language{Fortran}                      %\Revised{}
\Cernhead{Multinomial Random Numbers}
Subroutine subprogram {\tt RNMNML} generates a vector of random integers
$n_i>0 \, (i=1,2,\ldots,N)$ with probabilities $p_i$
according to the multinomial distribution
$$ Prob(n_1,n_2,\ldots,n_N) \ = \ \displaystyle
\frac{(n_1+n_2+\cdots+n_N)!}{n_1!\,n_2!\,\cdots\,n_N!}\,
p_1^{n_1}\,p_2^{n_2}\,\cdots\,p_N^{n_N}\,.$$
\Structure
{\tt SUBROUTINE} subprogram \\
User Entry Names: \Rdef{RNMNML}\\
External References: \Rind{RANLUX}{V115}
\Usage
\begin{verbatim}
    CALL RNMNML(N,NSUM,PCUM,NVEC,IERR)
\end{verbatim}
\begin{DLtt}{123456}
\item[N] ({\tt INTEGER}) Number $N$ of random integers $n_i$
requested.
\item[NSUM] ({\tt INTEGER}) $\sum_{i=1}^N n_i$, specified by the user.
\item[PCUM] ({\tt REAL}) One-dimensional array of length
$\mathtt{\ge N}$. Must contains, on entry, the (normalized)
cumulative channel probabilities $\sum_{j=1}^i p_j$
in $\mathtt{PCUM(i)\,(i=1,\ldots,N)}$. In particular,
$\mathtt{PCUM(N)=1}$.
\item[NVEC] ({\tt INTEGER}) One-dimensional array of length
$\mathtt{\ge N}$. On exit, {\tt NVEC(i),\,(i = 1,\ldots,N)}
contains the generated random integers.
\item[IERR] Error flag. \\
$\mathtt{= 0:}$ Normal case, \\
$\mathtt{= 1:}$ $\mathtt{PCUM(i) < PCUM(i-1)}$
for one {\tt i} al least, \\
$\mathtt{= 2:}$ $\mathtt{PCUM(N) \ne 1}$.
\end{DLtt}
\Notes
For $N=2$, use {\tt RNBNML} (V137).
\\ $\bullet$
@


1.2
log
@ Version of Feb. 28th
@
text
@d17 1
a17 1
External References: \Rind{RANLUX} (V115)
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
% 26.09.94 ksk
d11 3
a13 3
$$ Prob(n_1,n_2,\ldots,n_{N}) \ = \
\left( \sum_{i=1}^N n_i \right)! \  \prod_{i=1}^N
\frac {p_i^{n_{i}}} {n_i!}.$$
@
