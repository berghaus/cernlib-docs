<TITLE>HEPDB -- H1hdbappen-Extraction-and-Merging-of-database-records </TITLE>
<P>
<H1><A NAME=H1hdbappen-Extraction-and-Merging-of-database-records.html>Extraction and Merging of database records</A></H1>
<P>
<FILE
NAME=H2hdbappen-Copying-database-records-from-one-to-another-database>
<P>
<H2><A NAME=H1hdbappen-Extraction-and-Merging-of-database-records.html>Copying database records from one to another database</A></H2>
<H2><A HREF=H1hdbappen-Extraction-and-Merging-of-database-records.html>Copying database records from one to another database</A></H2>
<P>
There will probably be a need to extract only a subset of the contents of
a database to form a smaller private database. For maintaining the main
database, the manager will have to be able to merge new or updated records
from privately created database files into the main database, and there
will also be the need to create `snapshot' records of the status of the
current valid records in the database. Routine <A HREF=H1hdbappen-Extraction-and-Merging-of-database-records.html#HDBEXTR NAME=HDBEXTR311> HDBEXTR</A> serves these
<A HREF=H1hdbappen-Extraction-and-Merging-of-database-records.html#HDBEXTR NAME=HDBEXTR312> purposes.
<P>
HDBEXTR</A> extracts records from the subdirectory (or subdirectories)
specified by the path <A NAME=PATHI314> PATHI</A> only leads to a
directory, not a subdirectory) the <TT>NSDIR</TT>-element
<TT>CHARACTER</TT> vector <A NAME=CHDIR315> CHDIR</A>, which contains the subdirectory names
(optionally, records from all subdirectories are extracted). The extracted
records are valid for the period of validity specified in the integer
vector <A NAME=W317> W</A> option is not requested and there is more than one
valid current record, appropriate for the given type, in the range then a
series of summary records (each of which compresses the information from
the chain of records which apply to a part of the period of validity) is
created. The extracted record is written into the corresponding
subdirectory in the file with top-directory name <A NAME=PATHO318> PATHO</A>. There is also
additional information written which is needed for book-keeping when
databases are merged (see also option <A NAME=HDBSTOM321> HDBSTOM</A>). If the
user only wants a copy of the database records he can choose option <A NAME=M322> M</A>,
which suppresses the storing of merge informations. By default a brief
summary of all extracted records is printed, unless option <A NAME=N323> N</A> is specified.
If the user wishes to write the extracted records also on an FZ file he
should specify the option <A NAME=X324> X</A>, but note that the appropriated FZ calls
should have previously been issued before calling <A HREF=H1hdbappen-Extraction-and-Merging-of-database-records.html#HDBEXTR NAME=HDBEXTR325> HDBEXTR</A>.
<PRE>
        +--------------------------------------------------------+
        |CALL <A NAME=HDBEXTR> HDBEXTR</A> (PATHI,PATHO,KEYS,CHSDIR,NSECD,CHOPT,IRC*) |
        +--------------------------------------------------------+
                                  </PRE>
<P>
<DL>
<DT><TT>PATHI</TT></DT><DD>Full pathname of directory to be extracted.
<DT><TT>PATHO</TT></DT><DD>Name of top directory of the output database.
This database should not yet contain any of the subdirectories that are to
be copied from the main database, unless option <A NAME=O326> O</A> is requested.
<DT><TT>ISEL</TT></DT><DD>Vector specifying the required validity range.
<DT><TT>CHDIR</TT></DT><DD>Character array of subdirectories to be
extracted
<DT><TT>NSDIR</TT></DT><DD>Number elements in array <A NAME=CHDIR327> CHDIR</A>
<DT><TT>CHOPT</TT></DT><DD>Character variable containing a string of
single letter options
<DL>
<DT><TT>' '</TT></DT><DD>directory specified by <A NAME=PATHI328> PATHI</A> will be extracted
<DT><TT>'A'</TT></DT><DD>All subdirectories of the specified path will be
extracted
<DT><TT>'C'</TT></DT><DD>extract only records with key status bit copy set
<DT><TT>'I'</TT></DT><DD>extend the validity range beyond one experiment
number
<DT><TT>'M'</TT></DT><DD>no merge information will be stored
<DT><TT>'N'</TT></DT><DD>no summary will be printed
<DT><TT>'S'</TT></DT><DD>a selected subset of subdetector subdirectories
(specified in <A NAME=CHDIR329> CHDIR</A>) will be extracted
<DT><TT>'O'</TT></DT><DD>subdetector-subdirectories in <A NAME=PATHO330> PATHO</A> may exist
<DT><TT>'W'</TT></DT><DD>the whole number of stored records are copied to
the auxiliary database. However the key word containing the pointer to the
logging will be changed. The input values of <TT>ISEL</TT> are ignored.
<DT><TT>'X'</TT></DT><DD>write extracted records also to an FZ file, where
the FZ logical unit number is given by the logical unit number for
<TT>PATHO+10</TT>
</DL>
<DT><TT>IRC</TT></DT><DD>Return status
<DL>
<DT><TT>0</TT></DT><DD>Normal completion
</DL>
</DL>
<P>
<H2><A HREF=H2hdbappen-Merging-databases-or-database-records.html>Merging databases or database records</A></H2>
<H2><A HREF=H2hdbappen-Transferring-datastructures-to-and-from-FZ-files.html>Transferring datastructures to and from FZ files</A></H2>
<H2><A HREF=H2hdbappen-Converting-database-records-into-an-FZ-file.html>Converting database records into an FZ file</A></H2>
<H2><A HREF=H2hdbappen-Reading-database-records-from-FZ-files.html>Reading database records from FZ files</A></H2>
<H2><A HREF=H2hdbappen-Merging-FZ-files-written-by-HDBEXTR-or-HDBMERG.html>Merging FZ files written by <A HREF=!--!HDBEXTR!==! HREF=HDBEXTR383> HDBEXTR</A> or <A HREF=!--!HDBMERG!==! HREF=HDBMERG384> HDBMERG</A></A></H2>
