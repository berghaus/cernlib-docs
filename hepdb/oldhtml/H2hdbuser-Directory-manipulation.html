<TITLE>HEPDB -- H2hdbuser-Directory-manipulation </TITLE>
<P>
<H2><A NAME=H2hdbuser-Directory-manipulation.html>Directory manipulation</A></H2>
<P>
<H3>Creation</H3>
<P>
<PRE>
  +--------------------------------------------------------------------+
  | CALL <A NAME=CDMDIR> CDMDIR</A> (PATH,NKEYS,CHFOR,CHTAG,MAXOBJ,IPREC,DELTA,CHOPT,IRC*) |
  +--------------------------------------------------------------------+
                                  </PRE>
<P>
<DL>
<DT><TT>PATH</TT></DT><DD>Character string specifying the path name to be
created
<DT><TT>NKEYS</TT></DT><DD>Integer variable specifying the number of user
keys, if any. The directory will automatically be created with the
standard keys (system keys, experiment keys and the number of validity
range pairs as specified when the database was created).
<DT><TT>CHFOR</TT></DT><DD>Character string specifying the user key type,
as for the routine <A NAME=RZMDIR172> RZMDIR</A>
<DT><TT>CHTAG</TT></DT><DD>Character array of significant length <A NAME=NKEYS173> NKEYS</A>
containing the tags for the user keys
<DT><TT>MAXOBJ</TT></DT><DD>Integer variable specifying the maximum number
of objects to be stored in each partition of a partioned directory
<DT><TT>IPREC</TT></DT><DD>Precision word specifying the number of
significant digits to be stored (which may be zero). If <A NAME=IPREC174> IPREC</A> is negative,
then it specifies the number of digits to the left of the decimal point to
retain.
<DT><TT>DELTA</TT></DT><DD>Variable specifying the absolute value below
which data is treated as zero
<DT><TT>CHOPT</TT></DT><DD>
<DL>
<DT><TT>' '</TT></DT><DD>Default - non-partitioned directory
<DT><TT>'C'</TT></DT><DD>Data in this directory will be compressed by
default
<DT><TT>'P'</TT></DT><DD>Create partitioned directories
</DL>
<DT><TT>IRC</TT></DT><DD>Integer return code
<DL>
<DT><TT> 0</TT></DT><DD>Normal completion
<DT><TT>43</TT></DT><DD>Illegal number of user keys
</DL>
</DL>
<P>
This routine creates directories in a database and sets various directory
constants.
<P>
<H3>Conversion</H3>
<PRE>
              +--------------------------------------------+
              |CALL <A NAME=CDPART> CDPART</A> (PATHI,PATHO,MXPART,CHOPT,IRC*) |
              +--------------------------------------------+
                                  </PRE>
<P>
<DL>
<DT><TT>PATHI</TT></DT><DD>Character string describing the input pathname
<DT><TT>PATHO</TT></DT><DD>Character string describing the output pathname
<DT><TT>MXPART</TT></DT><DD>Maximum number of objects in each partition
<DT><TT>CHOPT</TT></DT><DD>Character string
<DT><TT>IRC</TT></DT><DD>Integer return code
<DL>
<DT><TT> 0</TT></DT><DD>Normal completion
<DT><TT>68</TT></DT><DD>Input directory is already partitioned
<DT><TT>71</TT></DT><DD>Illegal path name
<DT><TT>73</TT></DT><DD><A NAME=RZOUT175> RZOUT</A> fails to write on disk
<DT><TT>74</TT></DT><DD>Error in <A NAME=RZRENK176> RZRENK</A> in updating key values for data
set
<DT><TT>75</TT></DT><DD>Cannot find the Top directory name in pathname
<DT><TT>76</TT></DT><DD>Cannot form the IO descriptor for the FZ header
<DT><TT>77</TT></DT><DD><A NAME=FZOUT177> FZOUT</A> fails to write on to the sequential file
</DL>
</DL>
<P>
Transforms the contents of a non-partitioned directory to a partitioned
directory.
<H3>Deletion</H3>
<P>
<PRE>
                     +------------------------------+
                     |CALL <A NAME=CDDDIR> CDDDIR</A> (PATH,CHOPT,IRC*) |
                     +------------------------------+
                                  </PRE>
<P>
<DL>
<DT><TT>PATH</TT></DT><DD>Character string specifying the path name to be
deleted
<DT><TT>CHOPT</TT></DT><DD>Character variable specifying the options
required.
<DT><TT>IRC</TT></DT><DD>Integer return code
<DL>
<DT><TT>  0</TT></DT><DD>Normal completion
<DT><TT>171</TT></DT><DD>Illegal Path name
<DT><TT>172</TT></DT><DD>Cannot find the top directory for the path name
<DT><TT>173</TT></DT><DD>Error in RZ for reading the dictionary object
<DT><TT>174</TT></DT><DD>Error in <A NAME=FZOUT178> FZOUT</A> for saving the journal file
<DT><TT>175</TT></DT><DD>Error in RZ in writing the dictionary object
<DT><TT>176</TT></DT><DD>Error in RZ in purging the dictionary directory
<DT><TT>177</TT></DT><DD>Error in RZ in deleting the tree
</DL>
</DL>
<P>
<H3>Deleting partitions from a partitioned directory</H3>
<P>
<PRE>
                  +------------------------------------+
                  |CALL <A NAME=CDPURP> CDPURP</A> (PATH,NKEEP,CHOPT,IRC*) |
                  +------------------------------------+
                                  </PRE>
<P>
<DL>
<DT><TT>PATH</TT></DT><DD>Character array specifying the path names of the
directory tree to be purged.
<DT><TT>NKEEP</TT></DT><DD>Integer variable specifying the number of
partitions to keep. Only the last <A NAME=NKEEP179> NKEEP</A> partitions will be kept.
<DT><TT>CHOPT</TT></DT><DD>Character variable specifying the options
required.
<DT><TT>IRC</TT></DT><DD>Integer return code
<DL>
<DT><TT> 0</TT></DT><DD>Normal completion
<DT><TT>69</TT></DT><DD>Input directory is not partitioned
<DT><TT>70</TT></DT><DD>Error in deleting a partition
<DT><TT>71</TT></DT><DD>Illegal path name
<DT><TT>73</TT></DT><DD><A NAME=RZOUT180> RZOUT</A> fails to write on disk
<DT><TT>74</TT></DT><DD>Error in <A NAME=RZRENK181> RZRENK</A> in updating key values for
partitioned data set
<DT><TT>75</TT></DT><DD>Cannot find the Top directory name in pathname
<DT><TT>77</TT></DT><DD><A NAME=FZOUT182> FZOUT</A> fails to write on to the sequential file
</DL>
</DL>
<P>
This routine can be used to delete partitions from a partitioned
directory. Only the last <A NAME=NKEEP183> NKEEP</A> partitions will be kept.
<P>
<H3>Deleting multiple directory trees</H3>
<PRE>
                  +------------------------------------+
                  |CALL <A NAME=CDKEEP> CDKEEP</A> (PATH,NPATH,CHOPT,IRC*) |
                  +------------------------------------+
                                  </PRE>
<P>
<DL>
<DT><TT>PATH</TT></DT><DD>Character array specifying the path names of the
directory trees to be kept. All directory trees that are not in this list
will be deleted.
<DT><TT>NPATH</TT></DT><DD>Integer variable specifying the number of path
names in the character array <A NAME=PATH184> PATH</A>.
<DT><TT>CHOPT</TT></DT><DD>Character variable specifying the options
required.
<DT><TT>IRC</TT></DT><DD>Integer return code
<DL>
<DT><TT> 0</TT></DT><DD>Normal completion
<DT><TT>69</TT></DT><DD>Input directory is not partitioned
<DT><TT>70</TT></DT><DD>Error in deleting a partition
<DT><TT>71</TT></DT><DD>Illegal path name
<DT><TT>73</TT></DT><DD>RZOUT fails to write on disk
<DT><TT>74</TT></DT><DD>Error in <A NAME=RZRENK185> RZRENK</A> in updating key values for
partitioned data set
<DT><TT>75</TT></DT><DD>Cannot find the Top directory name in pathname
<DT><TT>77</TT></DT><DD><A NAME=FZOUT186> FZOUT</A> fails to write on to the sequential file
</DL>
</DL>
<P>
This routine can be used to delete all bar the specified directory trees
from a database.
<P>
