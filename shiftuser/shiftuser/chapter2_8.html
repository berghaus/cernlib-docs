<HEAD>
<TITLE> Batch Job Submission using NQS</TITLE>
</HEAD>
<BODY><P>
 <HR> <A NAME=tex2html164 HREF=chapter2_9.html><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/next_motif.gif"></A> <A NAME=tex2html162 HREF=shiftuser.html><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/up_motif.gif"></A> <A NAME=tex2html156 HREF=chapter2_7.html><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/previous_motif.gif"></A> <A NAME=tex2html166 HREF=tableofcontents2_1.html><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/contents_motif.gif"></A> <BR>
<B> Next:</B> <A NAME=tex2html165 HREF=chapter2_9.html> Using SHIFT Software</A>
<B>Up:</B> <A NAME=tex2html163 HREF=shiftuser.html>No Title</A>
<B> Previous:</B> <A NAME=tex2html157 HREF=chapter2_7.html> The SHIFT User </A>
<HR> <P>
<H1><A NAME=SECTION0080000000000000000> Batch Job Submission using NQS</A></H1>
<P>
<H1><A NAME=SECTION0081000000000000000> NQS - An Overview</A></H1>
<P>
The Network Queueing System, NQShas been installed on the SHIFT systems and is used for batch job submission.
The SHIFT implementation of the public domain version of NQS is
described here, together with an overview of the <i>shift</i>
batch environment.  For a detailed description of the NQS commands
<b>qstat, qsub, qlimit</b> and <b>qdel</b>, the reader is referred
the on-line man pages.
<P>
An NQS job is a series of UNIX commands combined in a SHELL script.
NQS works from job queues and the actual queues names and resource limits
are different for each SHIFT user group.
The NQS queue manager, <b>qmgr</b> is used by the system
administrator to change queue parameters and to set resource limits.
<P>
In general, NQS distinguishes between 2 types of queue:
<b>pipe</b> queues and <b>batch</b> queues.
Pipe queues are a mechanism to distribute jobs and balance the
workload evenly over the <tt>batch</tt> queues on the destination servers.
Users submit to the pipe queue and load balancing software
in NQS finds an empty server on which to run the job.
In the SHIFT environment, several <b>pipe</b> queues are created,
each with different CPU resource limits and the jobs from the different
queues run at different priorities.
<P>
NQS commands are located in the directory <tt>/usr/bin</tt> and
in <tt>/usr/local/bin.</tt>
Users submit batch requests with the <b>qsub</b>
command.  Batch requests are SHELL scripts which can be executed independently
of any user intervention.  A job should be submitted to the queue most
suited to its resource needs, principally based on required cpu time.
If no queue is specified, a job runs in the default queue,
which has very low priority.
A job's status can be checked with the command <b>qusage</b>.
A job may be stopped or removed from a queue with the <b>qdel</b> command.
<P>
All NQS commands work across machines within the
NQS domain.
<A NAME=tex2html7 HREF=shiftuser.foot.html#391><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/foot_motif.gif"></A>
A user need not log into the destination batch machine to
submit or delete jobs or to check a queue's status.
Instead, he may execute commands from any system in the NQS domain.
<P>
<H1><A NAME=SECTION0082000000000000000> NQS Commands</A></H1>
<P>
NQS provides a total of nine user commands:
<PRE><TT>qcat:         display output files of NQS running requests.
        qcmplx:       display status of NQS queue complexes.
        qdel:         delete or signal NQS requests.
        qhold:        hold NQS requests.
        qjob:         display status of NQS networked queues.
        qlimit:       show supported batch limits and shell strategy.
        qrls:         release NQS requests
        qstat:        display status of NQS requests and queues.
        qsub:         submit an NQS batch request.</TT></PRE>
<P>
In addition, 3 information commands have been provided in the
CERN version of NQS.
<P>
<PRE><TT>qorder:       display queue order
        qusage:       display NQS job execution time
        qresource:    display queue resource limits</TT></PRE>
<P>
To get more information about a particular command, type:
<P>
<PRE>



  man  command
</PRE><P><H2><A NAME=SECTION0082100000000000000> NQS Information Commands</A></H2>
<P>
    <UL><LI>[qorder]
The command <b>qorder</b> displays the latest ordering of the queue.
This is useful where NQS queue administrators change the execution order
of jobs in relation to budget levels, number of jobs running for this user etc.
<LI>[qusage]
<b>qusage</b> displays the  cumulative execution time in seconds for all
running NQS jobs.
<LI>[qresource]
<b>qresource</b> is a user command to display the available resources for
the different batch queues.
</UL><H1><A NAME=SECTION0083000000000000000> Some Notes on using NQS on SHIFT</A></H1>
<P>
<UL><LI> NQS will work for you across machines, but only if
you have the same user <i>and</i> group ids on all machines.
<LI> With care, all files should have the same relative pathname
on all machines (<i>e.g.</i> /cern/pro/lib) so job scripts with suitable
vendor-specific switches for compiling and linking should be able
to run on <i>any</i> hardware platform within <i>shift</i>.
<LI> If a batch machine crashes or undergoes a scheduled shutdown,
then at reboot, all jobs that had been running are restarted from
scratch.  For this reason, a user's job script should take care that any files
created by the job do not already exist from an earlier attempt to
run the job.  (Either delete them if they exist, or have the job
work in a unique directory.)
</UL><HR> <A NAME=tex2html164 HREF=chapter2_9.html><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/next_motif.gif"></A> <A NAME=tex2html162 HREF=shiftuser.html><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/up_motif.gif"></A> <A NAME=tex2html156 HREF=chapter2_7.html><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/previous_motif.gif"></A> <A NAME=tex2html166 HREF=tableofcontents2_1.html><IMG ALIGN=MIDDLE SRC="http://asis01.cern.ch/CN/CERNTEX/icons/contents_motif.gif"></A> <BR>
<B> Next:</B> <A NAME=tex2html165 HREF=chapter2_9.html> Using SHIFT Software</A>
<B>Up:</B> <A NAME=tex2html163 HREF=shiftuser.html>No Title</A>
<B> Previous:</B> <A NAME=tex2html157 HREF=chapter2_7.html> The SHIFT User </A>
<HR> <P>
<HR>

</BODY>
<P><ADDRESS>
<I>goossens@ <BR>
Fri Mar  4 17:06:49 MET 1994</I>
</ADDRESS>