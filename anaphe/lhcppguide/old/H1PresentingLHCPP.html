<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:date="http://www.jclark.com/xt/java/java.util.Date">
<head>
<title>Presenting LHC++</title>
<STYLE TYPE="text/css">body       { background: white; color: black}
 P.CENTERP  { text-align: center}
 TD.LISTING { background: #88FFFF; color: black; white-space: pre}
 tt         { color: red }
</STYLE>
</head>
<body>
<H1>
<A NAME="H1PresentingLHCPP">1. Presenting LHC++</A>
</H1>

<H2>1.1. A short historical introduction</H2>



<P>In 1995 a working group, called <EM>LHC++</EM>, consisting of
representatives of IT Division's ASD Group and of the various LHC
experiments, was created to investigate how the approximate equivalent
of the current CERNLIB environment could be provided in the LHC
era. Although the primary objectives of the discussions concentrated
on proposing solutions for future LHC experiments, it is essential
that other HEP experiments which are coming online in the next couple
of years will also be able to benefit from the proposed strategy.</P>

<P>It is clear that (industry) standard solutions should be used
whenever possible. This is nothing new since in the past commercial
libraries or programs, such as GKS/GTS, Numerical Algorithms Group
(NAG) libraries, Phigs, Historian, and CMZ)
have been used in the CERNLIB environment.  Intensive investment of
manpower should only be made in HEP-specific developments, where the
needed functionality cannot be obtained <EM>off the shelf</EM> at
affordable prices. An instance of such a HEP development is the CLHEP
class library, which is also a nice example of reuse.</P>










<P>Working closely with the LHC collaborations and other HEP
Laboratories in 1996 and 1997 an interim strategy was defined and a
number of licences for the commercial components was obtained.  When
several <EM>a priori</EM> solutions were available, a study was made
to determine which was the most suited in the HEP context.  We also
tested the proposed solutions at a few sites and ensured that it is a
workable environment.</P>



<H2>1.2. Objectives</H2>

<P>The main objective of LHC++ is to satisfy the requirements of the
LHC experiments in terms of the overall software environment that
today is provided by CERNLIB, as requested in these experiments'
<EM>Computing Technical Proposals</EM>
</P>


<P>This translates into the following key points for the short to
medium term:</P>

<UL> 
<LI>identify and provide key HEP-specific functions;</LI>
<LI>define affordable solutions for the non-HEP-specific parts;</LI>
<LI>monitor the non-HEP world for possible future useful
software;</LI>
<LI>study and understand the requirements of the LHC experiments for
C++-based mathematical libraries, and evaluate existing and future
developments, both commercial and otherwise in this area;</LI>
<LI>study the requirements for a minimisation package
(Minuit-replacement), in particular follow closely developments of
the STABLE project, which should provide the needed functionality,
both stand-alone and in the framework of IRIS Explorer;




</LI>
<LI>undertake a number of pilot projects with the experiments 
to test the overall functionality of the LHC++ environment;</LI>
<LI>supplement, where necessary, the existing documentation, both 
printed and online, with a set of user guides and tutorials;</LI>
<LI>agree with the experiments and other HEP laboratories on
a scheme for managing licenses, so that the best possible deals 
can be negotiated.</LI>
</UL>

<P>The scope of the LHC++ project covers the following:</P>

<UL>
<LI>foundation level class libraries;</LI>
<LI>mathematical libraries;</LI>
<LI>graphical libraries;</LI>
<LI>visualisation tool-kits, data analysis, histograms;</LI>
<LI>event generators (in collaboration with, e.g., Lund);</LI>
<LI>detector simulation (GEANT-4);

</LI>
<LI>object persistency (Objectivity/DB via RD45 at present).


</LI>
</UL>

<P>The primary focus is on C++-based solutions, although, of course,
developments in the software arena, in particular the increased
importance of Java, are closely watched.</P>



<H2>1.3. Collaboration with the experiments</H2>

<P>The LHC++ project is a joint effort between IT Division (mainly
ASD Group), the LHC experiments, plus NA45, Compass,...  Andreas
Pfeiffer is responsible for its overall coordination.</P>

<P>Regular (bi-weekly) LHC++ and RD45 meetings are held in Building 40. This
is an ideal forum for communication with the physics community since
its allows us to bring our users regularly up to date with the latest
news. Also, and more importantly, it provides us with an input channel
from the experiments about how they use the software, which are
possible problem areas which have to be addressed, and what are the
future developments they would like to see.
The minutes as well as material presented on the progress
in the various areas are available on the web 
(see <A HREF="http://wwwinfo.cern.ch/asd/lhc++/meetings.html">here</A>).
</P> 



<P>Twice a year a formal <EM>LHC++ Workshop</EM>
(see <A HREF="http://wwwinfo.cern.ch/asd/lhc++/workshops.html">here</A>)
take place where progress reports are presented by all HEP-wide
collaborations who are using LHC++ software. This Workshop provides an
efficient forum for feedback from the experiments and permits us to
steer long-term development in the right direction by taking into 
account constraints and requirements of as wide a user base as possible.</P>



<P>All three LCB common projects (GEANT-4, RD45, LHC++) stress the formal
gathering of use of requirements. Equally the priorities for these
projects, each of which is dominated by members of LHC and other
HEP experiments, are agreed at the level of the LCB, which is itself
mainly composed of experimental representatives.</P>



<H2>1.4. Current Situation</H2>

<P>
By using commodity solutions where-ever possible, we ensure that
the proposed solutions are widely used, well-debugged and well
documented, and are also more affordable. These solutions are being
complemented by HEP-specific components, where needed, by building a
HEP user-layer on top of standards-conforming products.
</P>

<P>
To ensure that the commercial components work well together, the
LHC++ strategy closely adheres to standards - both <EM>de-facto</EM>
and <EM>de-jure</EM>.  Examples of <EM>de-jure</EM> standards
include the <EM>Standard C++ Library</EM> (see 
<A HREF="http://www.objectspace.com/Products/CCS/Standards/standards.html">here</A>)
and ODMG-compliant Object Database Management
Systems (ODBMS), while instances of <EM>de-facto</EM> standards 
are industry standard graphics packages,
such as OpenGL, Open Inventor and IRIS Explorer
(see
<A HREF="http://www.nag.co.uk/visual/IE/iecbb/Tutorial/index.html">here</A> 
for a tutorial), all originally from Silicon Graphics (SGI).








</P>

<P>
The table below shows this layered structure more schematically.
Licenses for all commercial components are available at CERN, where
the software has been installed on all Unix platforms (Dec, HP, and
Sun for IRIS Explorer 3.9) on AFS in <TT>/afs/cern.ch/sw/lhcxx</TT>,
while on Nice/Windows/NT it is available under <TT>z:\p32\lhcxx</TT>.



</P>

<P>
<TABLE>
<TR>
<TD>GEANT-4, MCLIBS++</TD>
</TR>
<TR>
<TD>HEPExplorer, IRIS Explorer</TD>
</TR>
<TR>
<TD>HepVis, HEPInventor</TD>
</TR>
<TR>
<TD>OpenGL, Open Inventor, Master Suite</TD>
</TR>
<TR>
<TD>HepMATH, including GEMINI</TD>
</TR>
<TR>
<TD>NAG C library (with C++ headers)</TD>
</TR>
<TR>
<TD>CLHEP</TD>
</TR>
<TR>
<TD>HTL</TD>
</TR>
<TR>
<TD>HEPODBMS</TD>
</TR>
<TR>
<TD>ODMG, ODBMS (Objectivity/DB) + persistent STL</TD>
</TR>
<TR>
<TD>Standard C++ Libraries</TD>
</TR>
</TABLE>


</P>

<P>
All of the commercial LHC++ components come with excellent online
documentation. In most cases, printed documentation, often in the form
of published books, is also available and can be bought from the User
Consultancy Office (UCO) at CERN. HEP-specific examples and other
information specific to the HEP environment is clearly not available
from the vendors.
</P>

<P>
The main purpose of the present manual is to provide a tutorial
introduction to the use of LHC++ tools for physicist new to the LHC++
computing paradigm.  The current guide describes the present state of
some of the HEP extensions.  Their precise form and application
program interface (API) probably needs to be refined or extended in
a few places. Therefore we invite all users of the LHC++ software to
forward their comments and suggestions to the LHC++ team,
preferably at the LHC++ regular meetings mentioned above.
</P>





<H2>1.5. An overview of the commercial components</H2>

<P>The commercial components of LHC++ are chosen because they offer a
coherent set of inter-operable solutions. They are built on standards
and often come as part of the standard hardware or software bundled
with the computer. Cost effectiveness has also been optimised both
for CERN and for the general CERN HEP program participants.
</P>


<H3>1.5.1. OpenGL</H3>


<P>
<EM>OpenGL</EM> (see 
<A HREF="http://www.sgi.com/Products/Dev_environ_ds.html">here</A>)
is a industry standard for graphics. It is vendor-neutral and
multi-platform, and is optimised for building environments for
developing 2D and 3D visual applications. Several vendors already
offer a hardware implementation of the standard, thus ensuring
that rendering speed will be optimal.</P>

<P>
The about 250 OpenGL procedures provide a wide range of graphics
features, such as a set of geometric and raster primitives, various
colour modes, display list or immediate mode, viewing and modelling
transformations, lighting and shading, hidden surface removal and
translucency, anti-aliasing, texture mapping, effects using fog,
smoke, or haze, etc.  As all licensed OpenGL implementations are
required to pass a set of conformance tests, and implement the same
specification and language binding document full portability between
multiple platforms is guaranteed.</P>

<P>Documentation is available as two books: the <EM>OpenGL Programming
Guide</EM>, and the <EM>OpenGL Reference Manual</EM>, both published
by Addison and Wesley (and available from the UCO at CERN).</P>




<H3>1.5.2. Open Inventor</H3>


<P>
<EM>Open Inventor</EM> (see
<A HREF="http://www.sgi.com/Technology/Inventor/index.html">here</A>) is an
object-oriented 3D toolkit to provide a comprehensive solution to
interactive graphics programming.  Its programming model is based on a
3D scene database optimised to ease building graphics applications. It
includes a large set of objects, such as cubes, polygons, text,
materials, cameras, lights, track-balls, handle boxes, 3D viewers, and
editors.</P>

<P>
Open Inventor is built on top of OpenGL. It defines a standard file
format (IV) for 3D data interchange and introduces a simple event
model for 3D interaction. Animation is provided with
<EM>Engines</EM>. Open Inventor offers a convenient multi-platform
3D graphics development environment, which allows efficient
manipulation of objects in a windows and operating system independent
way.</P>

<P>
Open Inventor's IV files serve as the basis for the <EM>VRML
(Virtual Reality Modelling Language)</EM> standard (see
<A HREF="http://vrml.wired.com">here</A>). The Open Inventor toolkit is
conveniently documented in three books <EM>The Inventor
Mentor</EM>, <EM>The Inventor Toolmaker</EM>, and <EM>The Open
Inventor C++ Reference Manual</EM> published by Addison-Wesley
(available from the UCO at CERN).</P> 




<H3>1.5.3. MasterSuite</H3>


<P>
<EM>MasterSuite</EM> (see
<A HREF="http://wwwinfo.cern.ch/asd/lhc++/MASTER_SUITE/MasterDocHTML/msuite.htm">here</A>)
is a C++ toolkit for data visualisation, containing class libraries
with extension nodes to Open Inventor. These extensions cover 2D
drawing and charting, 3D drawing, legends, etc., and provide a set of
input devices to ease cross-platform design of user interfaces, as
well as set of classes to develop viewers for scientific data for
output on screen as well as on several types of printers in
vector-graphics mode.  It supports vector graphics output, in
particular PostScript output and is easily extensible by programming
new user-defined customisable objects.
</P>

<P>
MasterSuite comes with four components, DialogMaster, PlotMaster,
GraphMaster, and 3DDataMaster.  Because it is built on top of Open
Inventor you always have access to all Open Inventor rendering
capabilities, such as camera, lighting, texturing, fog, etc. Similarly
Master Suite node fields can interact with Open Inventor engines for
providing animation of building sensors to change data values.  Data
can be saved in an Open Inventor database and metafile, in particular
in IV format, thus allowing one to distribute visualisation over the
Internet in a natural and straightforward way.
</P>




<H3>1.5.4. IRIS Explorer</H3> 


<P>
<EM>IRIS Explorer</EM> (IE, see
<A HREF="http://www.sgi.com/Technology/explorer.html">here</A>) is a toolkit
for visualisation of scientific data, which can be manipulated via
visual programming tools.  Users analyse their data by connecting
building blocks, called <EM>modules</EM>.  Modules act like
<EM>filters</EM>: they read one of more streams of input data and
produce one of more streams of output data. The behaviour of modules
are controlled (interactively) by a set of parameters. IE comes will a
rather complete set of modules for performing basic data
transformations, and it is straightforward to create new modules.  It
is noteworthy that, because of its wide use, a lot of modules
developed by various user communities are available publicly, while
some can be obtained commercially (see below).
</P>

<P>
To transform user data, one constructs a <EM>map</EM>, which is a
network of interconnections between a set of modules. The various
components of a map can be manipulated individually and interactively,
and a map can be saved for later retrieval. If one of the modules is
time-consuming or needs special hardware then it can be run on a
different node of the network, thus parallel processing possibilities
are part of the system.


</P>

<P>
A well-written <EM>tutorial</EM> 
(see <A HREF="http://www.scs.leeds.ac.uk/iecoe/tutorial/main-frm.html">here</A>)
by the <EM>IRIS Explorer Centre of Excellence (IECOE)</EM> at the 
University of Leeds will you teach how to
master the basics of the program.
The <EM>IECOE website</EM> 
(<A HREF="http://www.scs.leeds.ac.uk/iecoe/">here</A>)
also provides a series of hyperlinks to other sites
from where IE modules can be downloaded. A printed and bound copy of
the <EM>IRIS Explorer User's Guide</EM> can be obtained from the
UCO.
 

</P>



<H3>1.5.5. Objectivity/DB, the Object Database</H3>


<P>
In order to study solutions for storing and handling the
multi-Pbyte data samples expected with LHC, the <EM>RD45
Project</EM> (see 
<A HREF="http://wwwinfo.cern.ch/asd/cernlib/rd45/index.html">here</A>) 
was established in 1995.  The proposed solution
should also be able to cope with other persistent objects, such as
histograms, calibration monitoring data, etc. It was found that the
best candidate for handling this problem is a <EM>ODMG</EM>
(Object Database Management Group, see
<A HREF="http://www.odmg.org/">here</A>) compliant object database used
together with a mass storage system, based upon the IEEE reference
model for mass storage systems. After considering a few alternatives,
the presently favoured solution uses 
<EM>Objectivity/DB</EM> (see <A HREF="http://www.objy.com/">here</A>)
and <EM>HPSS</EM> (High Performance Storage System,
see <A HREF="http://www.sdsc.edu/hpss/">here</A>)




</P>

<P>
The Objectivity/DB database provides object-persistency services for GEANT-4
and the experimental data. It must fully support HEP meta-data, not
only the persistent data collections themselves, but it must also
handle the selections producing these collections, and the predicates
themselves. Replication of large database images on local area and
wide area network configurations containing heterogeneous hardware
must allow collaborators all over the world to actively participate in
data analysis. Given the large time scales (the lifetime of the LHC
software will span at least twenty years) schema evolution and
versioning are important aspects which must be taken into account.
Objectivity/DB comes with a set of administrative tools to ease database
management. Objectivity/DB also comes with an <EM>Advanced Multi-threaded
Server</EM> (AMS) and an interface to HPSS.
This provides fast access to data and offers a large performance
improvement when updating data stored in remote databases. It is
expected that each experiment will run starting in 1998 a production
service of one or more of these servers.





</P>

<P>
Objectivity/DB has a layered logical storage level, with at its top the
<EM>federated database</EM>. Each federated database logically
contains one or more <EM>databases</EM>, with the latter containing
the <EM>objects</EM>, which are clustered, for efficiency, inside
<EM>containers</EM>. An <EM>object</EM> itself consists of standard
C++ constructs, variable-size arrays, relationships and references to
other objects, and type constraints. Persistent objects can be created
and deleted dynamically by any application. The data model, or
<EM>schema</EM> is stored inside the federated database.







</P>



<H3>1.5.6. Mathematical Libraries</H3>


<P>
CERN no longer has any in-house mathematician supporting mathematics
libraries. Therefore, we shall have to rely on libraries developed
outside CERN, and it was decided to make the <EM>NAG
C-language</EM> (see
<A HREF="http://www.nag.co.uk/numeric/CL.html">here</A>) library available.
Although the NAG C Library provides the basic functionality required
by HEP, a small number of routines (basically special functions) are
currently unavailable.  A future release of the above library is
likely to incorporate these routines.


</P>



<H3>1.5.7. Statistical Data Analysis: the Gemini package</H3>



<P>
Gemini is a GEneral MINImization and error analysis package
implemented as a C++ class library. Minuit's functionality is provided
in a <EM>Minuit-style</EM> (even if, internally, another minimizer
may actually do the work) and new functionality offered by NAG C
minimizers is added. Gemini thus provides a unified C++ API both to
standard Minuit and to NAG C family of minimizers. For the common
subset of functionality, it is up to the user which minimization
engine does the work: Minuit or NAG C. The user can easily switch
between various minimizers without essential changes in the
application code. The currently supported set of minimizers (Minuit
and NAG C) can be extended without essential changes in the API.
</P>

<P>
The abstract base class <TT>GEmini</TT> defines an interface to the
common functionality. The <TT>CMinuit</TT> class is derived from
<TT>GEmini</TT> and provides a Minuit-based implementation of the
GEmini functionality plus Minuit-specific extensions. Similarly, the
<TT>NAGmin</TT> class is derived from <TT>GEmini</TT> as well and
provides a NAG-based implementation of the <TT>GEmini</TT>
functionality plus NAG-specific extensions.


</P>

<P>
There is no single class which contains references both to Minuit and
to NAG C, so that orthodox Minuit or Nag C users are not forced to
link the other library.
</P>

<P>
Gemini finds a minimum of an objective function, possibly subject to
general constraints, and performs an error analysis. The concept of
errors is that of Minuit, so that it is the user's responsibility to
properly scale the inversed Hessian, and to properly interpret the
results. Both Hessian based errors and Minos errors are
implemented. Correspondingly, two types of function contours (or
confidence regions, in statistical problems) are available: elliptical
and Minos ones. Minos error analysis is, however, possible only for
bound constraint problems.
</P>

<P>On a longer timescale we are also following the STABLE Project,
which is funded by the European Commission and involves NAG and other
partners. The aim of the project is to design, build and demonstrate a
modern Statistical Application Building Environment.
</P>

<P>The STABLE project will integrate an existing application building
system, IRIS Explorer, and an existing widely used statistical
software system, Genstat, along with other available statistical
algorithms. The STABLE system will then be evaluated by constructing
end-user tools in different application areas.
</P>





<H2>1.6. Overview of the HEP-specific components</H2>

<P>
Although commercial and public-domain packages offer a great deal
of functionality, there is a clear need to supplement them with
HEP-specific extensions. Some of these extensions take the form of
complete class-libraries, such as CLHEP. Others represent large
toolkits, such as <EM>GEANT-4</EM> 
(see <A HREF="http://wwwinfo.cern.ch/asd/geant/geant4.html">here</A>).
Moreover, in areas such as graphics and visualisation, the basic
tools, such as Open Inventor for basic graphics and IRIS Explorer for
visualisation, need to be extended to cope with the specific needs of
the HEP experiments.



</P>


<H3>1.6.1. HEPODBMS</H3>


<P>
HepODBMS is a set of class libraries built on top of the ODMG C++
interface. Their purpose is to provide a higher level interface than
is specified by the ODMG, to simplify the porting of existing
applications and provide a minimum level of support for
transient-persistent switching. Furthermore, these libraries help to 
insulate applications against  changes between releases from 
a given vendor and between the products of different vendors.


</P>



<H3>1.6.2. CLHEP</H3>


<P>
The <EM>CLHEP</EM> project (see
<A HREF="http://wwwinfo.cern.ch/asd/lhc++/clhep/index.html">here</A>) was
initiated at CHEP'92; it intends to provide <EM>foundation
level</EM> classes required in HEP. At present they include:
<UL>
<LI>
<TT>Alist</TT> for lists and list iterators;</LI>
<LI>
<TT>Combination</TT>;</LI>
<LI>
<TT>Geometry</TT> for vectors, rotations, transformations;</LI>
<LI>
<TT>Matrix</TT> for matrix manipulations;</LI>
<LI>
<TT>Random</TT> for random numbers;</LI>
<LI>
<TT>String</TT> for different string types;</LI>
<LI>
<TT>Units</TT> for system of units and physical constants;</LI>
<LI>
<TT>Vector</TT> for vector operations (3-vector and Lorentz-type).</LI>
</UL>
</P>

<P>
CLHEP became formally part of LHC++ in 1995. The first official release
of CLHEP (V1.0) took place in April 1997 (CHEP'97). CLHEP-based
classes will be integrated in the beta-release of GEANT 4 early 1998.
The complete user documentation, with a detailed description of 
all classes is being written and will be available by the end of 1997.


</P>




<H3>1.6.3. The HTL class library</H3>

<P>
The HTL class library provides Object Oriented histograms.
They come in two versions:
<UL>
<LI>Persistent histograms (based on Objectivity/DB)</LI>
<LI>Transient histograms (text file I/O)</LI>
</UL>
</P>

<P>
For HEPExplorer (see below) the persistent version of the library is
needed, since HTL histograms are passed among IRIS Explorer Modules as
Objectivity/DB objects, identified by their object identifier (Objectivity/DB is used as
an <EM>object broker</EM> by the IE modules).
</P>




<H3>1.6.4. HEPInventor</H3>


<P>
<EM>HEPInventor</EM> (see
<A HREF="http://wwwinfo.cern.ch/asd/lhc++/dat/hepinventor.html">here</A>)
proposes an easily understandable and user-friendly way to present
data in physics programs. It is implemented as a graphical class
library build on top of MasterSuite (TGS) to provide an interface
between data structures (like HTL) and graphics.
 

</P> 




<H3>1.6.5. HepVis</H3>


<P>
The goal of the <EM>HepVis Project</EM> (see
<A HREF="http://www.cern.ch/Physics/Workshops/HepVis/">here</A>) is to create
and distribute a toolkit library consisting of graphical objects
capable of representing the most common entities of a collider physics
experiment. Previous experience has shown that mere representations of
objects on a workstation screen is insufficient, and that native
support for picking objects with user-defined actions, and a
high-degree of interactivity, both local and global, is needed.
Therefore, the HepVis toolkit is being implemented as an extension to
Open Inventor, providing common physics objects as subclasses or as
real extensions.  Only the graphical representation of the objects
will be defined, leaving it up to the experiments to define physics
objects and their behaviour, and whether to integrate these with the
graphical objects in question.

</P>




<H3>1.6.6. HEPExplorer</H3>


<P>
<EM>HEPExplorer (HE)</EM> is a set of HEP-specific IRIS Explorer
modules, which help a physicist set up an environment to analyse
experimental data, produce histograms, fit models and prepare data
presentation plots using LHC++'s IE framework. It is based on
HEPInventor, HTL, and HepODBMS.
</P>

<P>
HEPExplorer consists of the following parts.
</P>

<UL>
<LI>
<P>
<EM>IRIS Explorer user types for HEP</EM>
</P> 
<P>
In order to extend
the type of data that can be passed among IRIS Explorer Modules, new
data types have been defined to deal with HEP objects.
</P>
</LI>
<LI>
<P>
<EM>IRIS Explorer HEP-specific modules</EM>
</P> 
<P>
A set of HEP-specific IRIS Explorer modules is stored on AFS/Nice
and is available after setting up your environment in an appropriate
way. These modules allow for histogram handling and Ntuple-like
analysis.

</P>
</LI>
</UL>

<P>
Note that, since HE needs Objectivity/DB to store HTL histograms and their
associated schema, an Objectivity/DB database is a prerequisite for using
HEPExplorer with HTL.


</P> 





<H2>
<A NAME="S-GNATS">1.7. Problem tracking</A>
</H2>

<P>
LHC++ has been incorporated into the GNATS-based 
<EM>IT Problem Report Management
System</EM> (<A HREF="http://gnats.cern.ch/">here</A>), 
under the heading <EM>LHC++ Support Services</EM>.

</P>
 
<P>
Users are invited to primarily use this system to submit problem
reports. This ensures that the problems are documented, can be easily
tracked, and also become available to other users, who can then browse
the problem database and profit from the proposed solutions.
</P>

<hr>
<address>
 Last updated: mg Mon Sep 06 12:05:53 GMT+03:30 1999<br>
</address>
</body>
</html>
