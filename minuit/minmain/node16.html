<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.2 (September 6th, 1998)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Running Minuit in Fortran-callable mode.</TITLE>
<META NAME="description" CONTENT="Running Minuit in Fortran-callable mode.">
<META NAME="keywords" CONTENT="minmain">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="minmain.css">
<LINK REL="previous" HREF="node15.html">
<LINK REL="up" HREF="node13.html">
<LINK REL="next" HREF="node17.html">
</HEAD>
<BODY >
<!--Navigation Panel-->
<A NAME="tex2html276"
 HREF="node17.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/local/share/latex2html/icons.gif/next_motif.gif"></A> 
<A NAME="tex2html272"
 HREF="node13.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/local/share/latex2html/icons.gif/up_motif.gif"></A> 
<A NAME="tex2html268"
 HREF="node15.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/local/share/latex2html/icons.gif/previous_motif.gif"></A>  
<A NAME="tex2html274"
 HREF="node35.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index"
 SRC="/usr/local/share/latex2html/icons.gif/index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html277"
 HREF="node17.html">Minuit Commands</A>
<B> Up:</B> <A NAME="tex2html273"
 HREF="node13.html">How to Use Minuit</A>
<B> Previous:</B> <A NAME="tex2html269"
 HREF="node15.html">Running Minuit in Data-driven</A>
 &nbsp <B>  <A NAME="tex2html275"
 HREF="node35.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html278"
 HREF="node16.html#SECTION00531000000000000000">Initialize Minuit</A>
<LI><A NAME="tex2html279"
 HREF="node16.html#SECTION00532000000000000000">Specify a title for a problem</A>
<LI><A NAME="tex2html280"
 HREF="node16.html#SECTION00533000000000000000">Define a parameter, assigning values from variables</A>
<LI><A NAME="tex2html281"
 HREF="node16.html#SECTION00534000000000000000">Define a parameter, assigning values from character string</A>
<LI><A NAME="tex2html282"
 HREF="node16.html#SECTION00535000000000000000">Execute a Minuit command</A>
<LI><A NAME="tex2html283"
 HREF="node16.html#SECTION00536000000000000000">Execute a Minuit command specified as a character string</A>
<LI><A NAME="tex2html284"
 HREF="node16.html#SECTION00537000000000000000">Get the current value of a parameter</A>
<LI><A NAME="tex2html285"
 HREF="node16.html#SECTION00538000000000000000">Get the current status of minimization</A>
<LI><A NAME="tex2html286"
 HREF="node16.html#SECTION00539000000000000000">Get the current value of the covariance matrix</A>
<LI><A NAME="tex2html287"
 HREF="node16.html#SECTION005310000000000000000">Access current parameter errors</A>
<LI><A NAME="tex2html288"
 HREF="node16.html#SECTION005311000000000000000">Find a function contour with the MNContour method</A>
<LI><A NAME="tex2html289"
 HREF="node16.html#SECTION005312000000000000000">Switch to command-reading mode</A>
<LI><A NAME="tex2html290"
 HREF="node16.html#SECTION005313000000000000000">Set logical unit number for input</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION00530000000000000000">
Running Minuit in Fortran-callable mode.</A>
</H1>

<P>
The following Minuit subroutines are provided in order to allow
the user to communicate with Minuit and perform all Minuit
functions (define parameters, execute commands, etc.) directly
from Fortran through subroutine calls.
In the following list of subroutines, output arguments are indicated
by appending a star <TT>*</TT> to its name.
It should also be noted that for the Double Precision version of
Minuit (recommended for all 32-bit machines such as IBM, Vax,
Unix workstations, etc.), all the <TT>REAL</TT> arguments given below must be
declared <TT>DOUBLE PRECISION</TT>.

<P>

<H2><A NAME="SECTION00531000000000000000">
Initialize Minuit</A>
</H2>
 
<A NAME=MNINIT><TT>CALL MNINIT (IRD,IWR,ISAV)</TT><br></A>
 
<DL COMPACT>
<DT><B>Input parameters:</B>
<DD>
<DT>IRD
<DD>  Unit number for input to Minuit.
<DT>IWR
<DD>  Unit number for output from Minuit.
<DT>ISAV
<DD> Unit number for use of the SAVE command.
</DL>
<H2><A NAME="SECTION00532000000000000000">
Specify a title for a problem</A>
</H2>
 
<A NAME=MNSETI><TT>CALL MNSETI (CTITLE)</TT><br></A>
 
<DL COMPACT>
<DT><B>Input parameter:</B>
<DD>
<DT>CTITLE
<DD> Character string of up to 50 characters containing
              an identification text for the present job or fit.
</DL>
<H2><A NAME="SECTION00533000000000000000">
Define a parameter, assigning values from variables</A>
</H2>
 
<A NAME=MNPARM><TT>CALL MNPARM (NUM,CHNAM,STVAL,STEP,BND1,BND2,IERFLG*)</TT><br></A>
 
<DL COMPACT>
<DT><B>Input parameters:</B>
<DD>
<DT>NUM
<DD>    Parameter number as referenced by user in <TT>FCN</TT><A NAME="1393"></A>.
<DT>CHNAM
<DD>  Character string of up to 10 characters containing
              the name which the user assigned to the given parameter.
<DT>STVAL
<DD>  Starting value
<DT>STEP
<DD>   Starting step size or approximate parameter error.
<DT>BND1
<DD>   Lower bound (limit) on parameter value, if any (see below).
<DT>BND2
<DD>   Upper bound (limit) on parameter value, if any (see below).
<DT><B>Output parameter:</B>
<DD>
<DT>IERFLG
<DD> Error return code: <TT>0</TT> if no error, <TT>&gt;0</TT> if request failed.
</DL>
 
If <TT>BND1=BND2=0.</TT>, then the parameter is considered unbounded, which
is recommended unless limits are needed to make things behave well.

<P>

<H2><A NAME="SECTION00534000000000000000">
Define a parameter, assigning values from character string</A>
</H2>
       Subroutine MNPARS defines a new (or redefines an old) parameter
specifying values for its number, name, starting value, step size, and
limits if any.  All these values are given in one character string as
if it was being read from the input stream.  It can therefore be used
in place of MNPARM if the character string format is more convenient
than the calling sequence of MNPARM.

<P>
Calling sequence:

<P>
<A NAME=MNPARS><TT>CALL MNPARS (CHSTR,ICONDN*)</TT><br></A>

<P>
<DL COMPACT>
<DT><B>Input parameter:</B>
<DD>
<DT>CHSTR
<DD> String specifies the parameter definition in the usual Minuit
  format, as on a data record (See 3.2.1). The fields are in the same order
  as the arguments to MNPARM
<DT><B>Output parameter:</B>
<DD>
<DT>ICONDN
<DD> Output condition
</DL>
<DL COMPACT>
<DT><B>Possible values of output condition:</B>
<DD>
<DT>ICONDN=0
<DD>    all OK
<DT>ICONDN=1
<DD>    error, attempt to define parameter is ignored
<DT>ICONDN=2
<DD>    end of parameter definitions (parameter number zero)
</DL>

<P>
<B>Example:</B>
<PRE>
      CALL MNPARS(' 15  ''Lambda Mass''  1.2, 0.1' , ICONDN)
</PRE>

<P>

<H2><A NAME="SECTION00535000000000000000">
Execute a Minuit command</A>
</H2>
 
<A NAME=MNEXCM><TT>CALL MNEXCM (FCN,CHCOM,ARGLIS,NARG,IERFLG*,FUTIL)</TT><br></A>
 
<DL COMPACT>
<DT><B>Input parameters:</B>
<DD>
<DT>FCN
<DD>    Name of the function being analyzed (to be declared <TT>EXTERNAL</TT>)
<DT>CHCOM
<DD>  Character string containing the name of the Minuit
              command to be executed (see below).
<DT>ARGLIS
<DD> Array of dimension <TT>MAXARG</TT>, containing the numeric arguments 
              to the command (if any),
<DT>NARG
<DD>   Number of arguments specified (<TT>NARG</TT><IMG
 WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img14.gif"
 ALT="$\leq$">MAXARG),
<DT>FUTIL
<DD>  Name of a function called by <TT>FCN</TT><A NAME="1396"></A> (or <TT>=0</TT> if not used).
              If used this function must be declared <TT>EXTERNAL</TT>.
<DT><B>Output parameter:</B>
<DD>
<DT>IERFLG
<DD> Error return code: <TT>0</TT> if the command was executed normally, 
              <TT>&gt;0</TT> otherwise.
</DL>
 
Executing a command by calling <TT>MNEXCM</TT><A NAME="1399"></A> has exactly the same
effect as reading the same command in data-driven mode, except that
a few commands would make no sense and are not available in
Fortran-callable mode (e.g. <TT>SET INPUT</TT><A NAME="1402"></A>).
The other difference is that <B>control always returns to the
calling routine from <TT>MNEXCM</TT><A NAME="1405"></A></B>, even after commands <TT>END</TT><A NAME="1408"></A>,
<TT>EXIT</TT><A NAME="1411"></A>, and <TT>STOP</TT><A NAME="1414"></A>.

<P>

<H2><A NAME="SECTION00536000000000000000">
Execute a Minuit command specified as a character string</A>
</H2>
   Subroutine MNCOMD causes the execution of the Minuit command specified
as the second argument.  It therefore works like MNEXCM, except that it
accepts the entire command with arguments as one character string.
This is more convenient in many cases and avoids problems of word length
matching (DOUBLE PRECISION constants).

<P>
<A NAME=MNCOMD><TT>CALL MNCOMD (FCN,CHSTR,ICONDN*,FUTIL)</TT><br></A>

<P>
<DL COMPACT>
<DT><B>Input parameters:</B>
<DD>
<DT>FCN
<DD>    Name of the function being analyzed (to be declared <TT>EXTERNAL</TT>)
<DT>CHSTR
<DD>  The full Minuit command with arguments (CHARACTER)
<DT>FUTIL
<DD>  Name of a function called by <TT>FCN</TT><A NAME="1417"></A> (or <TT>=0</TT> if not used).
              If used this function must be declared <TT>EXTERNAL</TT>.
<DT><B>Output parameter:</B>
<DD>
<DT>ICONDN
<DD> Error return code: <TT>0</TT> if the command was executed normally, 
              <TT>&gt;0</TT> otherwise.
</DL>
 
<DL COMPACT>
<DT><B>Some abnormal conditions:</B>
<DD>
<DT>ICONDN=1
<DD>  command was blank, ignored
<DT>ICONDN=2
<DD>  command line was unreadable, ignored
<DT>ICONDN=3
<DD>  command was unknown, ignored
<DT>ICONDN=4
<DD>  abnormal termination (e.g., MIGRAD not converged)
</DL>
<H2><A NAME="SECTION00537000000000000000">
Get the current value of a parameter</A>
</H2>

<P>
This routine is the inverse of <TT>MNPARM</TT><A NAME="1420"></A> and
can for instance be used after a fit.

<P>
<A NAME=MNPOUT><TT>CALL MNPOUT (NUM,CHNAM*,VAL*,ERROR*,BND1*,BND2*,IVARBL*)</TT><br></A>
 
<DL COMPACT>
<DT><B>Input parameter:</B>
<DD>
<DT>NUM
<DD>    Parameter number as referenced by user in <TT>FCN</TT><A NAME="1423"></A> and
              about which information is required.
<DT><B>Output parameters:</B>
<DD>
<DT>CHNAM
<DD>  Character string of up to 10 characters containing
              the name which the user assigned to the given parameter.
<DT>VAL
<DD>    Current parameter value (fitted value if fit has converged),
<DT>ERROR
<DD>  Current estimate of parameter uncertainty (or zero if constant)
<DT>BND1
<DD>   Lower limit on parameter value, if any (otherwise zero).
<DT>BND2
<DD>   Upper limit on parameter value, if any (otherwise zero).
<DT>IVARBL
<DD> Internal parameter number if parameter is variable, or
              zero if parameter is constant, or negative if parameter is undefined.
</DL>
<H2><A NAME="SECTION00538000000000000000">
Get the current status of minimization</A>
</H2>

<P>
<A NAME=MNSTAT><TT>CALL MNSTAT (FMIN*,FEDM*,ERRDEF*,NPARI*,NPARX*,ISTAT*)</TT><br></A>
 
<DL COMPACT>
<DT><B>Output parameters:</B>
<DD>
<DT>FMIN
<DD>   The best function value found so far
<DT>FEDM
<DD>   The estimated vertical distance remaining to minimum
<DT>ERRDEF
<DD> The value of <TT>UP</TT> defining parameter uncertainties
<DT>NPARI
<DD>  The number of currently variable parameters
<DT>NPARX
<DD>  The highest (external) parameter number defined by user
<DT>ISTAT
<DD>  A status integer indicating how good is the covariance matrix:
              <DL COMPACT>
                <DT>0
<DD> Not calculated at all
                <DT>1
<DD> Diagonal approximation only, not accurate
                <DT>2
<DD> Full matrix, but forced positive-definite
                <DT>3
<DD> Full accurate covariance matrix (After <TT>MIGRAD</TT><A NAME="1426"></A>, 
                         this is the indication of normal convergence.)
              </DL>
</DL>
<H2><A NAME="SECTION00539000000000000000">
Get the current value of the covariance matrix</A>
</H2>

<P>
<A NAME=MNEMAT><TT>CALL MNEMAT (EMAT*,NDIM)</TT><br></A>
 
<DL COMPACT>
<DT><B>Input parameter:</B>
<DD>
<DT>NDIM
<DD>   Integer variable specifying the number of rows and columns
              the suer has reserved in <TT>EMAT</TT> to store the matrix elements.
              <TT>NDIM</TT> should be at least as large as the number of parameters 
              variable at the time of the call, otherwise the user will get
              only part of the full matrix.
<DT><B>Output parameter:</B>
<DD>
<DT>EMAT
<DD>   Array declared as <TT>DIMENSION EMAT(NDIM,NDIM)</TT> which
              is to be filled with the (external) covariance matrix.
</DL>
<H2><A NAME="SECTION005310000000000000000">
Access current parameter errors</A>
</H2>

<P>
<A NAME=MNERRS><TT>CALL MNERRS (NUM,EPLUS*,EMINUS*,EPARAB*,GLOBCC*)</TT><br></A>
 
<DL COMPACT>
<DT><B>Input parameter:</B>
<DD>
<DT>NUM
<DD>    Parameter number. 
              If <TT>NUM&gt;0</TT>, this is taken to be an external parameter number; 
              if <TT>NUM&lt;0</TT>, it is the negative of an internal parameter number.
<DT><B>Output parameters:</B>
<DD>
<DT>EPLUS
<DD>  The positive <TT>MINOS</TT><A NAME="1429"></A> error of parameter <TT>NUM</TT>.
<DT>EMINUS
<DD> The negative <TT>MINOS</TT><A NAME="1432"></A> error (a negative number).
<DT>EPARAB
<DD> The ``parabolic'' parameter error, from the error matrix.
<DT>GLOBCC
<DD> The global correlation coefficient for parameter <TT>NUM</TT>.
              This is a number between zero and one which gives the correlation
              between parameter <TT>NUM</TT> and that linear combination of all other
              parameters which is most strongly correlated with <TT>NUM</TT>.
</DL>
 
Note that this call does not cause the errors to be
calculated, it merely returns the current existing values.
If any of the requested values has not been calculated, or has
been destroyed (for example, by a redefinition of parameter values)
<TT>MNERRS</TT><A NAME="1435"></A> returns a value of zero for that argument.
Thus the call to <TT>MNERRS</TT><A NAME="1438"></A> will normally follow the execution of
commands <TT>MIGRAD</TT><A NAME="1441"></A>, <TT>HESSE</TT><A NAME="1444"></A>, 
<TT>MNContour</TT><A NAME="1447"></A>, and/or <TT>MINOS</TT><A NAME="1450"></A>.

<H2><A NAME="SECTION005311000000000000000">
Find a function contour with the MNContour method</A>
</H2>

<P>
<A NAME=MNCONT><TT>CALL MNCONT (FCN,NUM1,NUM2,NPT,XPT*,YPT*,NFOUND*,FUTIL)</TT><br></A>
 
<DL COMPACT>
<DT><B>Input parameters:</B>
<DD>
<DT>FCN
<DD>    Name of the function being treated (to be declared <TT>EXTERNAL</TT>)
<DT>NUM1/2
<DD> Parameter numbers with respect to which the contour
              is to be determined (external).
<DT>NPT
<DD>    The number of points required on the contour (<TT>&gt;4</TT>).
<DT>FUTIL
<DD>  Name of a function called by <TT>FCN</TT><A NAME="1453"></A> (or =0 if not used).
              If used this function must be declared <TT>EXTERNAL</TT>.
<DT><B>Output parameters:</B>
<DD>
<DT>XPT
<DD>    Array of x-coordinates of contour points with 
              values for parameter <TT>NUM1</TT>.
              It must be declared with a <TT>DIMENSION XPT(NPT)</TT>.
<DT>YPT
<DD>    Array of y-coordinates of contour points with
              values for parameter <TT>NUM2</TT>.
              It must be declared with a <TT>DIMENSION YPT(NPT)</TT>.
<DT>NFOUND
<DD> The number of points actually found on the contour.
              If all goes well, this will be equal to <TT>NPT</TT>, but it can be
              negative (if the input arguments are not valid), or zero if
              less than four points have been found, or less than <TT>NPT</TT> if the
              program could not find <TT>NPT</TT> points.
</DL>
 
Note that alternatively <TT>MNContour</TT><A NAME="1456"></A> can be calculated
by calling <TT>MNEXCM</TT><A NAME="1459"></A> to issue the <TT>MNContour</TT><A NAME="1462"></A> command,
but then the user does not have Fortran access to the actual
point coordinates <TT>XPT</TT> and <TT>YPT</TT>.

<H2><A NAME="SECTION005312000000000000000">
Switch to command-reading mode</A>
</H2>

<P>
This facility can be useful when one wants to continue interactively.

<P>
<A NAME=MNINTR><TT>CALL MNINTR (FCN,FUTIL)</TT><br></A>
 
<DL COMPACT>
<DT><B>Input parameters:</B>
<DD>
<DT>FCN
<DD>    Name of the function being treated (to be declared <TT>EXTERNAL</TT>)
<DT>FUTIL
<DD>  Name of a function called by <TT>FCN</TT><A NAME="1465"></A> (or <TT>=0</TT> if not used).
              If used this function must be declared <TT>EXTERNAL</TT>.
</DL>
 
The call to <TT>MNINTR</TT><A NAME="1468"></A> will cause Minuit to read commands from
the unit <TT>IRD</TT> (originally specified by the user in his call to <TT>MNINIT</TT><A NAME="1471"></A>,
<TT>IRD</TT> is usually 5 by default,
which in turn is usually the terminal by default).
Minuit then reads and executes commands until it encounters
a command <TT>END</TT><A NAME="1474"></A>, <TT>EXIT</TT><A NAME="1477"></A>, <TT>RETurn</TT><A NAME="1480"></A>, or <TT>STOP</TT><A NAME="1483"></A>, 
or an end-of-file on input
(or an unrecoverable error condition while reading
or trying to execute a command), in which case control returns
to the program which called <TT>MNINTR</TT><A NAME="1486"></A>.

<P>

<H2><A NAME="SECTION005313000000000000000">
Set logical unit number for input</A>
</H2>

<P>
Sets logical unit number of input unit from which Minuit will read
the next command.

<P>
<A NAME=MNINPU><TT>CALL MNINPU (NUNIT, IERR*)</TT><br></A>

<P>
<DL COMPACT>
<DT><B>Input parameters:</B>
<DD>
<DT>NUNIT
<DD>   The I/O unit number, which must be a valid unit, opened
   for reading (Minuit makes no checks at this level and will not attempt
   to open any files.)  
<DT>IERR
<DD>    returned as zero unless Minuit's internal buffer which 
          stores unit numbers is full, which is a fatal error.  If
          NUNIT is specified as zero, Minuit returns to reading the previous
          unit (which is why it has to store them).
</DL>

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html276"
 HREF="node17.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/local/share/latex2html/icons.gif/next_motif.gif"></A> 
<A NAME="tex2html272"
 HREF="node13.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/local/share/latex2html/icons.gif/up_motif.gif"></A> 
<A NAME="tex2html268"
 HREF="node15.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/local/share/latex2html/icons.gif/previous_motif.gif"></A>  
<A NAME="tex2html274"
 HREF="node35.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index"
 SRC="/usr/local/share/latex2html/icons.gif/index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html277"
 HREF="node17.html">Minuit Commands</A>
<B> Up:</B> <A NAME="tex2html273"
 HREF="node13.html">How to Use Minuit</A>
<B> Previous:</B> <A NAME="tex2html269"
 HREF="node15.html">Running Minuit in Data-driven</A>
 &nbsp <B>  <A NAME="tex2html275"
 HREF="node35.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
Back to
<a href="http://www.cern.ch">CERN</a>
| <a href="http://wwwinfo.cern.ch/Welcome.html">IT</a>
| <a href="http://wwwinfo.cern.ch/asd">ASD</a>
| <a href="http://wwwinfo.cern.ch/asd/index.html">CERN Program Library Home</a>
<address><a name=mg
href="http://consult.cern.ch/xwho/people/01575">
MG</a> 
(last mod. 1998-10-30)
</address>
</ADDRESS>
</BODY>
</HTML>
