<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.2 (September 6th, 1998)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Convergence in MIGRAD, and Positive-definiteness.</TITLE>
<META NAME="description" CONTENT="Convergence in MIGRAD, and Positive-definiteness.">
<META NAME="keywords" CONTENT="minmain">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="minmain.css">
<LINK REL="next" HREF="node26.html">
<LINK REL="previous" HREF="node24.html">
<LINK REL="up" HREF="node19.html">
<LINK REL="next" HREF="node26.html">
</HEAD>
<BODY >
<!--Navigation Panel-->
<A NAME="tex2html421"
 HREF="node26.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/local/share/latex2html/icons.gif/next_motif.gif"></A> 
<A NAME="tex2html417"
 HREF="node19.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/local/share/latex2html/icons.gif/up_motif.gif"></A> 
<A NAME="tex2html411"
 HREF="node24.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/local/share/latex2html/icons.gif/previous_motif.gif"></A>  
<A NAME="tex2html419"
 HREF="node35.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index"
 SRC="/usr/local/share/latex2html/icons.gif/index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html422"
 HREF="node26.html">Additional Trouble-shooting</A>
<B> Up:</B> <A NAME="tex2html418"
 HREF="node19.html">How to get the</A>
<B> Previous:</B> <A NAME="tex2html412"
 HREF="node24.html">Interpretation of Parameter Errors</A>
 &nbsp <B>  <A NAME="tex2html420"
 HREF="node35.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION00760000000000000000">
Convergence in MIGRAD, and Positive-definiteness.</A>
</H1>

<P>
<TT>MIGRAD</TT><A NAME="3837"></A> uses its current estimate of the covariance matrix of the
function to determine the current search direction, since this is
the optimal strategy for quadratic functions and ``physical'' functions
should be quadratic in the neighbourhood of the minimum at least.
The search directions determined by <TT>MIGRAD</TT><A NAME="3840"></A> are guaranteed to be
downhill only if the covariance matrix is positive-definite,
so in case this is not true, it makes a positive-definite
approximation by adding an appropriate constant along the diagonal
as determined by the eigenvalues of the matrix.
Theoretically, the covariance matrix for a ``physical'' function must be
positive-definite at the minimum, although it may not be so
for all points far away from the minimum, even for a well-determined
physical problem. 
Therefore, if <TT>MIGRAD</TT><A NAME="3843"></A> reports that it has found a
non-positive-definite covariance matrix, this may be
a sign of one or more of the following:

<P>

<UL><LI><B>A non-physical region.</B>
      On its way to the minimum, <TT>MIGRAD</TT><A NAME="3846"></A>
      may have traversed a region which has
      unphysical behaviour, which is of course not a serious problem as long
      as it recovers and leaves such a region.

<LI><B>An underdetermined problem.</B>
      If the matrix is not positive-definite even at the minimum,
      this may mean that the solution is not well-defined, for example
      that there are more unknowns than there are data points, or that the
      parametrization of the fit contains a linear dependence.
      If this is the case, then Minuit (or any other program) cannot solve
      your problem uniquely, and the error matrix will necessarily be
      largely meaningless, so the user must remove the underdeterminedness
      by reformulating the parametrization. Minuit cannot do this itself,
      but it can provide some hints (contours, global correlation coefficients,
      eigenvalues) which can help the clever user to find out what is wrong.

<LI><B>Numerical inaccuracies.</B>
      It is possible that the apparent lack of positive-definiteness
      is in fact only due to excessive roundoff errors in numerical
      calculations, either in <TT>FCN</TT><A NAME="3849"></A> or in Minuit.
      This is unlikely in general, but becomes more likely if the number of
      free parameters is very large, or if the parameters are badly scaled
      (not all of the same order of magnitude), and correlations are
      also large.
      In any  case, whether the non-positive-definiteness is
      real or only numerical is largely irrelevant, since in both cases the
      error matrix will be unreliable and the minimum suspicious.

</UL>

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html421"
 HREF="node26.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="/usr/local/share/latex2html/icons.gif/next_motif.gif"></A> 
<A NAME="tex2html417"
 HREF="node19.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="/usr/local/share/latex2html/icons.gif/up_motif.gif"></A> 
<A NAME="tex2html411"
 HREF="node24.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="/usr/local/share/latex2html/icons.gif/previous_motif.gif"></A>  
<A NAME="tex2html419"
 HREF="node35.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index"
 SRC="/usr/local/share/latex2html/icons.gif/index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html422"
 HREF="node26.html">Additional Trouble-shooting</A>
<B> Up:</B> <A NAME="tex2html418"
 HREF="node19.html">How to get the</A>
<B> Previous:</B> <A NAME="tex2html412"
 HREF="node24.html">Interpretation of Parameter Errors</A>
 &nbsp <B>  <A NAME="tex2html420"
 HREF="node35.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
Back to
<a href="http://www.cern.ch">CERN</a>
| <a href="http://wwwinfo.cern.ch/Welcome.html">IT</a>
| <a href="http://wwwinfo.cern.ch/asd">ASD</a>
| <a href="http://wwwinfo.cern.ch/asd/index.html">CERN Program Library Home</a>
<address><a name=mg
href="http://consult.cern.ch/xwho/people/01575">
MG</a> 
(last mod. 1998-10-30)
</address>
</ADDRESS>
</BODY>
</HTML>
